<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AutoScore: An Interpretable Machine Learning-Based Automatic Clinical Score Generator - 6&nbsp; AutoScore for ordinal outcomes (AutoScore-Ordinal)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-autoscore_survival.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AutoScore for ordinal outcomes (AutoScore-Ordinal)</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">AutoScore: An Interpretable Machine Learning-Based Automatic Clinical Score Generator</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">AutoScore introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-related_papers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Related papers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data_processing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data processing and checking</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-desc_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Descriptive analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-autoscore.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AutoScore for binary outcomes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-autoscore_survival.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AutoScore for survival outcomes (AutoScore-Survival)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-autoscore_ordinal.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AutoScore for ordinal outcomes (AutoScore-Ordinal)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#demo1" id="toc-demo1" class="nav-link active" data-scroll-target="#demo1"><span class="toc-section-number">6.1</span>  Demo 1: large sample</a>
  <ul class="collapse">
  <li><a href="#stepi-generate-variable-ranking-list" id="toc-stepi-generate-variable-ranking-list" class="nav-link" data-scroll-target="#stepi-generate-variable-ranking-list"><span class="toc-section-number">6.1.1</span>  STEP(i): generate variable ranking list</a></li>
  <li><a href="#large-data" id="toc-large-data" class="nav-link" data-scroll-target="#large-data"><span class="toc-section-number">6.1.2</span>  STEP(ii): select model with parsimony plot</a></li>
  <li><a href="#stepiii-generate-initial-scores-with-final-variables" id="toc-stepiii-generate-initial-scores-with-final-variables" class="nav-link" data-scroll-target="#stepiii-generate-initial-scores-with-final-variables"><span class="toc-section-number">6.1.3</span>  STEP(iii): generate initial scores with final variables</a></li>
  <li><a href="#fine-tune" id="toc-fine-tune" class="nav-link" data-scroll-target="#fine-tune"><span class="toc-section-number">6.1.4</span>  STEP(iv): fine-tune initial score from STEP(iii)</a></li>
  <li><a href="#stepv-evaluate-final-risk-scores-on-test-dataset" id="toc-stepv-evaluate-final-risk-scores-on-test-dataset" class="nav-link" data-scroll-target="#stepv-evaluate-final-risk-scores-on-test-dataset"><span class="toc-section-number">6.1.5</span>  STEP(v): evaluate final risk scores on test dataset</a></li>
  <li><a href="#demo1-map" id="toc-demo1-map" class="nav-link" data-scroll-target="#demo1-map"><span class="toc-section-number">6.1.6</span>  Map score to risk</a></li>
  </ul></li>
  <li><a href="#demo2" id="toc-demo2" class="nav-link" data-scroll-target="#demo2"><span class="toc-section-number">6.2</span>  Demo 2: small sample</a>
  <ul class="collapse">
  <li><a href="#stepi-generate-variable-ranking-list-1" id="toc-stepi-generate-variable-ranking-list-1" class="nav-link" data-scroll-target="#stepi-generate-variable-ranking-list-1"><span class="toc-section-number">6.2.1</span>  STEP(i): generate variable ranking list</a></li>
  <li><a href="#stepii-select-the-best-model-with-parsimony-plot" id="toc-stepii-select-the-best-model-with-parsimony-plot" class="nav-link" data-scroll-target="#stepii-select-the-best-model-with-parsimony-plot"><span class="toc-section-number">6.2.2</span>  STEP(ii): select the best model with parsimony plot</a></li>
  <li><a href="#stepiii-generate-initial-scores-with-final-variables-1" id="toc-stepiii-generate-initial-scores-with-final-variables-1" class="nav-link" data-scroll-target="#stepiii-generate-initial-scores-with-final-variables-1"><span class="toc-section-number">6.2.3</span>  STEP(iii): generate initial scores with final variables</a></li>
  <li><a href="#stepiv-fine-tune-initial-score-from-stepiii" id="toc-stepiv-fine-tune-initial-score-from-stepiii" class="nav-link" data-scroll-target="#stepiv-fine-tune-initial-score-from-stepiii"><span class="toc-section-number">6.2.4</span>  STEP(iv): fine-tune initial score from STEP(iii)</a></li>
  <li><a href="#stepv-evaluate-final-risk-scores-on-test-dataset-1" id="toc-stepv-evaluate-final-risk-scores-on-test-dataset-1" class="nav-link" data-scroll-target="#stepv-evaluate-final-risk-scores-on-test-dataset-1"><span class="toc-section-number">6.2.5</span>  STEP(v): evaluate final risk scores on test dataset</a></li>
  <li><a href="#map-score-to-risk" id="toc-map-score-to-risk" class="nav-link" data-scroll-target="#map-score-to-risk"><span class="toc-section-number">6.2.6</span>  Map score to risk</a></li>
  </ul></li>
  <li><a href="#demo-3-data-with-missing-values" id="toc-demo-3-data-with-missing-values" class="nav-link" data-scroll-target="#demo-3-data-with-missing-values"><span class="toc-section-number">6.3</span>  Demo 3: data with missing values</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="top" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AutoScore for ordinal outcomes (AutoScore-Ordinal)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>AutoScore-Ordinal refers to the AutoScore framework for developing point-based scoring models for ordinal outcomes. Similar to the implementation described in <a href="./04-autoscore.html#top">Chapter 4</a> for binary outcomes, AutoScore-Ordinal is implemented by five functions: <code>AutoScore_rank_Ordinal()</code>, <code>AutoScore_parsimony_Ordinal()</code>, <code>AutoScore_weighting_Ordinal()</code>, <code>AutoScore_fine_tuning_Ordinal()</code> and <code>AutoScore_testing_Ordinal()</code>.</p>
<p>In this chapter, we demonstrate the use of AutoScore-Ordinal to develop sparse risk scores for an ordinal outcome, adjust parameters to improve interpretability, assess the performance of the final model and map the score to predict risks for new data. To facilitate clinical applications, in the following sections we demonstrate AutoScore application in 3 demos with large and small datasets and with missing information.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Scoring models below are based on simulated data to demonstrate AutoScore usage.</em></li>
<li><em>Variable names are intentionally masked to avoid misinterpretation and misuse.</em></li>
</ul>
</div>
</div>
<p>Cite the following paper for AutoScore-Ordinal:</p>
<ul>
<li>Saffari SE, Ning Y, Xie F, Chakraborty B, Volovici V, Vaughan R, Ong MEH, Liu N, <a href="https://doi.org/10.48550/arxiv.2202.08407">AutoScore-Ordinal: An interpretable machine learning framework for generating scoring models for ordinal outcomes</a>, arXiv:2202.08407.</li>
</ul>
<section id="demo1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="demo1"><span class="header-section-number">6.1</span> Demo 1: large sample</h2>
<p>In Demo 1, we demonstrate the use of AutoScore-Ordinal on a dataset with 20,000 observations using split-sample approach (i.e., to randomly divide the full dataset into training, validation and test sets) for model development.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>- Before proceeding, follow the steps in <a href="./03-data_processing.html#top">Chapter 2</a> to ensure all data requirements are met.</em> <em>- Refer to <a href="./02-desc_analysis.html#ordinal">Chapter 3</a> for how to generate simple descriptive statistics before building prediction models.</em></p>
</div>
</div>
<p class="p-h3">
Load package and data
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AutoScore)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sample_data_ordinal"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sample_data_ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20000    21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample_data_ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  label Age Gender Util_A Util_B Util_C    Util_D Comorb_A Comorb_B Comorb_C
1     1  63 FEMALE     P2      0   0.00 3.5933333        0        0        0
2     1  41 FEMALE     P2      0   0.96 3.6288889        0        0        0
3     1  86   MALE     P1      0   0.00 2.6502778        0        0        0
4     1  51   MALE     P2      0   0.00 4.9711111        0        0        0
5     1  23 FEMALE     P1      0   0.00 0.5352778        0        0        0
6     1  32 FEMALE     P2      0   4.13 4.4008333        0        0        0
  Comorb_D Comorb_E Lab_A Lab_B Lab_C Vital_A Vital_B Vital_C Vital_D Vital_E
1        0        0   117   3.9   136      91      19     100      70     152
2        1        0   500   3.6   114      91      16     100      70     147
3        0        0    72   4.1   136     100      18      99      65     126
4        0        0    67   5.0   122      73      17      97      46     100
5        0        0  1036   4.1   138      74      18      98      89     114
6        0        0   806   4.1   136      77      18      98      74     157
  Vital_F
1    25.7
2    22.6
3    25.7
4    24.9
5    25.7
6    25.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_data_ordinal</span>(sample_data_ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data type check passed. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No NA in data. </code></pre>
</div>
</div>
<p class="p-h3">
Prepare training, validation, and test datasets
</p>
<ul>
<li>Option 1: Prepare three separate datasets to train, validate, and test models.</li>
<li>Option 2: Use demo codes below to randomly split your dataset into training, validation, and test datasets (70%, 10%, 20%, respectively), possibly stratified by outcome categories (<code>strat_by_label = TRUE</code>) to ensure they are well represented in all three datasets.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_ordinal, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>), </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">strat_by_label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stepi-generate-variable-ranking-list" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="stepi-generate-variable-ranking-list"><span class="header-section-number">6.1.1</span> STEP(i): generate variable ranking list</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 1
</p>
<ul>
<li>Variables are ranked by random forest for multiclass classification.</li>
<li><code>ntree</code>: Number of trees in the random forest algorithm (Default: 100).</li>
</ul>
<div class="cell" data-hash="06-autoscore_ordinal_cache/html/rank_ord_dc8b418fb5d945b790aabe6025ab0ef5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Ordinal</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ranking based on variable importance was shown below for each variable: 
   Util_D     Lab_A   Vital_F   Vital_A       Age   Vital_E   Vital_D     Lab_B 
413.60631 379.51127 378.30195 372.84319 372.68880 364.51371 339.60643 296.86038 
    Lab_C    Util_C    Util_B   Vital_C   Vital_B  Comorb_A    Util_A    Gender 
279.47643 244.28653 201.34337 186.47331 168.45639 115.28191  98.78811  51.88705 
 Comorb_B  Comorb_D  Comorb_C  Comorb_E 
 41.11154  32.31979  17.64803  11.87098 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/rank_ord-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="large-data" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="large-data"><span class="header-section-number">6.1.2</span> STEP(ii): select model with parsimony plot</h3>
<p class="autoscore-module">
AutoScore-Ordinal Modules 2+3+4
</p>
<ul>
<li><code>n_min</code>: Minimum number of selected variables (Default: 1).</li>
<li><code>n_max</code>: Maximum number of selected variables (Default: 20).</li>
<li><code>categorize</code>: Methods for categorizing continuous variables. Options include <code>"quantile"</code> or <code>"kmeans"</code> (Default: <code>"quantile"</code>).</li>
<li><code>quantiles</code>: Predefined quantiles to convert continuous variables to categorical ones. (Default: <code>c(0, 0.05, 0.2, 0.8, 0.95, 1)</code>) Available if <code>categorize = "quantile"</code>.</li>
<li><code>max_cluster</code>: The maximum number of cluster (Default: 5). Available if <code>categorize = "kmeans"</code>.</li>
<li><code>max_score</code>: Maximum total score (Default: 100).</li>
<li><code>auc_lim_min</code>: Minimum y_axis limit in the parsimony plot (Default: 0.5).</li>
<li><code>auc_lim_max</code>: Maximum y_axis limit in the parsimony plot (Default: “adaptive”).</li>
<li><code>link</code>: link function in the ordinal regression, which affects predictive performance. Options include <code>"logit"</code> (for proportional odds model), <code>"cloglog"</code> (for proportional hazard model) and <code>"probit"</code> (Default: <code>"logit"</code>).</li>
</ul>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Use the same <code>link</code> parameter throughout descriptive analysis and model building steps.</em></p>
</div>
</div>
<div class="cell" data-hash="06-autoscore_ordinal_cache/html/mauc_ord_4b7faeb989104a47d0ae49c00d44fd98">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>link <span class="ot">&lt;-</span> <span class="st">"logit"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Ordinal</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> ranking, <span class="at">link =</span> link, <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="dv">0</span>, <span class="at">auc_lim_max =</span> <span class="st">"adaptive"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Select 1 variables:  Mean area under the curve: 0.4555607 
Select 2 variables:  Mean area under the curve: 0.5110174 
Select 3 variables:  Mean area under the curve: 0.5780548 
Select 4 variables:  Mean area under the curve: 0.5912554 
Select 5 variables:  Mean area under the curve: 0.6685143 
Select 6 variables:  Mean area under the curve: 0.672106 
Select 7 variables:  Mean area under the curve: 0.6690071 
Select 8 variables:  Mean area under the curve: 0.6710102 
Select 9 variables:  Mean area under the curve: 0.6706072 
Select 10 variables:  Mean area under the curve: 0.6721932 
Select 11 variables:  Mean area under the curve: 0.7003498 
Select 12 variables:  Mean area under the curve: 0.6995013 
Select 13 variables:  Mean area under the curve: 0.6994186 
Select 14 variables:  Mean area under the curve: 0.7476355 
Select 15 variables:  Mean area under the curve: 0.7489346 
Select 16 variables:  Mean area under the curve: 0.7448716 
Select 17 variables:  Mean area under the curve: 0.744752 
Select 18 variables:  Mean area under the curve: 0.744752 
Select 19 variables:  Mean area under the curve: 0.745261 
Select 20 variables:  Mean area under the curve: 0.7472124 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/mauc_ord-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>mAUC</code> for further analysis or export it to CSV to other software for plotting.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(mAUC), <span class="at">file =</span> <span class="st">"mAUC.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Determine the optimal number of variables (<code>num_var</code>) based on the parsimony plot obtained in STEP(ii).</li>
<li>The final list of variables is the first <code>num_var</code> variables in the ranked list <code>ranking</code> obtained in STEP(i).</li>
<li>Optional: User can adjust the finally included variables <code>final_variables</code> based on the clinical preferences and knowledge.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Top 5 variables are selected</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: Top 14 variables are selected</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: Top 5 variables, the 11th and 14th variable are selected</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">14</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stepiii-generate-initial-scores-with-final-variables" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="stepiii-generate-initial-scores-with-final-variables"><span class="header-section-number">6.1.3</span> STEP(iii): generate initial scores with final variables</h3>
<p class="autoscore-module">
Re-run AutoScore-Ordinal Modules 2+3
</p>
<ul>
<li>Generate <code>cut_vec</code> with current cutoffs of continuous variables, which can be fine-tuned in STEP(iv).</li>
<li>Performance of resulting scores is evaluated using the mean AUC across dichotomous classifications (mAUC), with 95% CI computed using bootstrap (Default: <code>n_boot = 100</code> bootstrap samples). Setting <code>n_boot = 1</code> disables bootstrap and reports mAUC without CI.</li>
<li>Run time increases with larger <code>n_boot</code> value. Code below uses <code>n_boot = 10</code> for demonstration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Ordinal</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">link =</span> link, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1        Util_D
2         Lab_A
3       Vital_F
4       Vital_A
5           Age
6        Util_B
7      Comorb_A
****Initial Scores: 


========  ============  =====
variable  interval      point
========  ============  =====
Util_D    &lt;0.652          7  
          [0.652,1.32)    7  
          [1.32,3.93)     2  
          [3.93,5.93)     1  
          &gt;=5.93          0  
                             
Lab_A     &lt;46             6  
          [46,61)         0  
          [61,134)        1  
          [134,584)       8  
          &gt;=584           6  
                             
Vital_F   &lt;16.7           8  
          [16.7,20.5)     4  
          [20.5,25.4)     0  
          [25.4,28.1)     1  
          &gt;=28.1          4  
                             
Vital_A   &lt;58             2  
          [58,68)         0  
          [68,97)         3  
          [97,113)        6  
          &gt;=113          13  
                             
Age       &lt;27             0  
          [27,46)         4  
          [46,78)        14  
          [78,87)        18  
          &gt;=87           21  
                             
Util_B    &lt;1              0  
          [1,4)          10  
          &gt;=4            21  
                             
Comorb_A  0               0  
          1              22  
========  ============  =====
***Performance (based on validation set):
mAUC: 0.7402     95% CI: 0.7157-0.7593 (from 10 bootstrap samples)
***The cutoffs of each variables generated by the AutoScore-Ordinal are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>
</section>
<section id="fine-tune" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="fine-tune"><span class="header-section-number">6.1.4</span> STEP(iv): fine-tune initial score from STEP(iii)</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 5 &amp; Re-run AutoScore-Ordinal Modules 2+3
</p>
<ul>
<li>Revise <code>cut_vec</code> with domain knowledge to update the scoring table (AutoScore-Ordinal Module 5).</li>
<li>Re-run AutoScore-Ordinal Modules 2+3 to generate the updated scores.</li>
<li>Users can choose any cutoff values and/or any number of categories, but are suggested to choose numbers close to the automatically determined values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For example, we have current cutoffs of continuous variable: Age </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## variable        interval     point</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Age                 &lt;27          0  </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [27,46)      4  </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [46,78)     14  </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [78,87)     18 </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                     &gt;=87        21 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Current cutoffs:<code>c(27, 46, 78, 87)</code>. We can fine tune the cutoffs as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: rounding to a nice number</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: changing cutoffs according to clinical knowledge or preference </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: combining categories</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>mAUC and 95% bootstrap CI (Default: <code>n_boot = 100</code> bootstrap samples) are reported after fine-tuning.</li>
<li>Run time increases with larger <code>n_boot</code> value. Code below uses <code>n_boot = 10</code> for demonstration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Util_D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">4</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Vital_F <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">28</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Vital_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">95</span>, <span class="dv">115</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">135</span>, <span class="dv">595</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>scoring_table <span class="ot">&lt;-</span> <span class="fu">AutoScore_fine_tuning_Ordinal</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">link =</span> link, <span class="at">cut_vec =</span> cut_vec,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Fine-tuned Scores: 


========  ============  =====
variable  interval      point
========  ============  =====
Util_D    &lt;0.667          7  
          [0.667,1.33)    7  
          [1.33,4)        2  
          [4,6)           1  
          &gt;=6             0  
                             
Lab_A     &lt;45             7  
          [45,60)         0  
          [60,135)        1  
          [135,595)       8  
          &gt;=595           6  
                             
Vital_F   &lt;17             8  
          [17,20)         4  
          [20,25)         0  
          [25,28)         0  
          &gt;=28            4  
                             
Vital_A   &lt;60             0  
          [60,70)         0  
          [70,95)         2  
          [95,115)        5  
          &gt;=115          13  
                             
Age       &lt;25             0  
          [25,45)         4  
          [45,75)        14  
          [75,85)        19  
          &gt;=85           22  
                             
Util_B    &lt;1              0  
          [1,4)          10  
          &gt;=4            21  
                             
Comorb_A  0               0  
          1              22  
========  ============  =====
***Performance (based on Validation Set, after fine-tuning):
mAUC: 0.7466     95% CI: 0.7369-0.7633 (from 10 bootstrap samples)</code></pre>
</div>
</div>
</section>
<section id="stepv-evaluate-final-risk-scores-on-test-dataset" class="level3" data-number="6.1.5">
<h3 data-number="6.1.5" class="anchored" data-anchor-id="stepv-evaluate-final-risk-scores-on-test-dataset"><span class="header-section-number">6.1.5</span> STEP(v): evaluate final risk scores on test dataset</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 6
</p>
<ul>
<li>mAUC and generalised c-index are reported for the test set, with 95% bootstrap CI (Default: <code>n_boot = 100</code> bootstrap samples).</li>
<li>Run time increases with larger <code>n_boot</code> value. Code below uses <code>n_boot = 10</code> for demonstration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pred_score <span class="ot">&lt;-</span> <span class="fu">AutoScore_testing_Ordinal</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_set =</span> test_set, <span class="at">link =</span> link, <span class="at">final_variables =</span> final_variables, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cut_vec =</span> cut_vec, <span class="at">scoring_table =</span> scoring_table, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">with_label =</span> <span class="cn">TRUE</span>, <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Performance using AutoScore-Ordinal (based on unseen test Set):
mAUC: 0.7552     95% CI: 0.7585-0.7776 (from 10 bootstrap samples)
Generalised c-index: 0.7267      95% CI: 0.7229-0.7378 (from 10 bootstrap samples)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pred_score Label
1         40     1
2         35     1
3         29     1
4         26     1
5         33     1
6         22     1</code></pre>
</div>
</div>
<ul>
<li>Users can compute mAUC and generalised c-index (with 95% bootstrap CI) for previously saved <code>pred_score</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_performance_ordinal</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> pred_score<span class="sc">$</span>Label, <span class="at">score =</span> pred_score<span class="sc">$</span>pred_score, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_boot =</span> <span class="dv">10</span>, <span class="at">report_cindex =</span> <span class="cn">TRUE</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mAUC: 0.7552     95% CI: 0.7400-0.7632 (from 10 bootstrap samples)
Generalised c-index: 0.7267      95% CI: 0.7155-0.7360 (from 10 bootstrap samples)</code></pre>
</div>
</div>
</section>
<section id="demo1-map" class="level3" data-number="6.1.6">
<h3 data-number="6.1.6" class="anchored" data-anchor-id="demo1-map"><span class="header-section-number">6.1.6</span> Map score to risk</h3>
<ul>
<li>The interactive figure below maps score to predicted risks.</li>
<li><code>point_size</code>: Size of points indicating all attainable scores (Default: 0.5).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predicted_risk</span>(<span class="at">pred_score =</span> pred_score, <span class="at">max_score =</span> <span class="dv">100</span>, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">final_variables =</span> final_variables, <span class="at">link =</span> link,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">scoring_table =</span> scoring_table, <span class="at">point_size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-552935f571d32b1c0f48" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-552935f571d32b1c0f48">{"x":{"data":[{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.9786801242071,0.977065236595082,0.975331111539291,0.97346942752638,0.971471357554621,0.969327550312923,0.967028112685972,0.964562594024918,0.961919972687097,0.959088645417365,0.956056420217095,0.952810513424225,0.949337551807546,0.94562358055948,0.941654078151608,0.937413979093821,0.932887705707825,0.928059210084918,0.92291202744188,0.917429342111888,0.911594067403411,0.90538894052208,0.89879663367099,0.891799882315783,0.884381631414102,0.876525200156797,0.868214465443547,0.859434063912775,0.850169611861496,0.840407941824616,0.830137353938918,0.819347879502851,0.808031553373663,0.796182691038901,0.783798165387451,0.770877677420473,0.757424014425456,0.743443288533242,0.728945148137349,0.71394295442724,0.698453915319634,0.682499169405182,0.666103813192025,0.649296865937934,0.632111167715699,0.614583208027366,0.596752884224562,0.578663191134698,0.560359845546673,0.541890851469707,0.523306014230632,0.504656413402711,0.485993846153996,0.467370253772358,0.448837144797491,0.430445028326785,0.412242870653306,0.394277587465423,0.376593582444794,0.359232341324874,0.342232088417956,0.325627510398165,0.309449549857062,0.293725268938105,0.278477781304337,0.263726248880279,0.249485938292959,0.235768330754056,0.222581278289171,0.209929198724796,0.197813301665554,0.186231837797783,0.17518036419603,0.164652018837402,0.154637798195112,0.145126832539032,0.136106654374169,0.127563456260007,0.119482335043684,0.111847520283929,0.104642585323193,0.0978506400712812,0.0914545050890423,0.0854368670038668,0.0797804156518029,0.0744679636287022,0.069482549151272,0.0648075232857765,0.0604266227053859,0.0563240291949011,0.0524844171415982,0.0488929902405068,0.045535508608197,0.0423983074469462,0.0394683083360713,0.0367330241535385,0.0341805585522785,0.0317996008348165,0.029579416989176,0.0275098375702841,0.0255812430355965],"text":["Outcome category: 1<br />Score:   0<br />Predicted risk: 0.978680124","Outcome category: 1<br />Score:   1<br />Predicted risk: 0.977065237","Outcome category: 1<br />Score:   2<br />Predicted risk: 0.975331112","Outcome category: 1<br />Score:   3<br />Predicted risk: 0.973469428","Outcome category: 1<br />Score:   4<br />Predicted risk: 0.971471358","Outcome category: 1<br />Score:   5<br />Predicted risk: 0.969327550","Outcome category: 1<br />Score:   6<br />Predicted risk: 0.967028113","Outcome category: 1<br />Score:   7<br />Predicted risk: 0.964562594","Outcome category: 1<br />Score:   8<br />Predicted risk: 0.961919973","Outcome category: 1<br />Score:   9<br />Predicted risk: 0.959088645","Outcome category: 1<br />Score:  10<br />Predicted risk: 0.956056420","Outcome category: 1<br />Score:  11<br />Predicted risk: 0.952810513","Outcome category: 1<br />Score:  12<br />Predicted risk: 0.949337552","Outcome category: 1<br />Score:  13<br />Predicted risk: 0.945623581","Outcome category: 1<br />Score:  14<br />Predicted risk: 0.941654078","Outcome category: 1<br />Score:  15<br />Predicted risk: 0.937413979","Outcome category: 1<br />Score:  16<br />Predicted risk: 0.932887706","Outcome category: 1<br />Score:  17<br />Predicted risk: 0.928059210","Outcome category: 1<br />Score:  18<br />Predicted risk: 0.922912027","Outcome category: 1<br />Score:  19<br />Predicted risk: 0.917429342","Outcome category: 1<br />Score:  20<br />Predicted risk: 0.911594067","Outcome category: 1<br />Score:  21<br />Predicted risk: 0.905388941","Outcome category: 1<br />Score:  22<br />Predicted risk: 0.898796634","Outcome category: 1<br />Score:  23<br />Predicted risk: 0.891799882","Outcome category: 1<br />Score:  24<br />Predicted risk: 0.884381631","Outcome category: 1<br />Score:  25<br />Predicted risk: 0.876525200","Outcome category: 1<br />Score:  26<br />Predicted risk: 0.868214465","Outcome category: 1<br />Score:  27<br />Predicted risk: 0.859434064","Outcome category: 1<br />Score:  28<br />Predicted risk: 0.850169612","Outcome category: 1<br />Score:  29<br />Predicted risk: 0.840407942","Outcome category: 1<br />Score:  30<br />Predicted risk: 0.830137354","Outcome category: 1<br />Score:  31<br />Predicted risk: 0.819347880","Outcome category: 1<br />Score:  32<br />Predicted risk: 0.808031553","Outcome category: 1<br />Score:  33<br />Predicted risk: 0.796182691","Outcome category: 1<br />Score:  34<br />Predicted risk: 0.783798165","Outcome category: 1<br />Score:  35<br />Predicted risk: 0.770877677","Outcome category: 1<br />Score:  36<br />Predicted risk: 0.757424014","Outcome category: 1<br />Score:  37<br />Predicted risk: 0.743443289","Outcome category: 1<br />Score:  38<br />Predicted risk: 0.728945148","Outcome category: 1<br />Score:  39<br />Predicted risk: 0.713942954","Outcome category: 1<br />Score:  40<br />Predicted risk: 0.698453915","Outcome category: 1<br />Score:  41<br />Predicted risk: 0.682499169","Outcome category: 1<br />Score:  42<br />Predicted risk: 0.666103813","Outcome category: 1<br />Score:  43<br />Predicted risk: 0.649296866","Outcome category: 1<br />Score:  44<br />Predicted risk: 0.632111168","Outcome category: 1<br />Score:  45<br />Predicted risk: 0.614583208","Outcome category: 1<br />Score:  46<br />Predicted risk: 0.596752884","Outcome category: 1<br />Score:  47<br />Predicted risk: 0.578663191","Outcome category: 1<br />Score:  48<br />Predicted risk: 0.560359846","Outcome category: 1<br />Score:  49<br />Predicted risk: 0.541890851","Outcome category: 1<br />Score:  50<br />Predicted risk: 0.523306014","Outcome category: 1<br />Score:  51<br />Predicted risk: 0.504656413","Outcome category: 1<br />Score:  52<br />Predicted risk: 0.485993846","Outcome category: 1<br />Score:  53<br />Predicted risk: 0.467370254","Outcome category: 1<br />Score:  54<br />Predicted risk: 0.448837145","Outcome category: 1<br />Score:  55<br />Predicted risk: 0.430445028","Outcome category: 1<br />Score:  56<br />Predicted risk: 0.412242871","Outcome category: 1<br />Score:  57<br />Predicted risk: 0.394277587","Outcome category: 1<br />Score:  58<br />Predicted risk: 0.376593582","Outcome category: 1<br />Score:  59<br />Predicted risk: 0.359232341","Outcome category: 1<br />Score:  60<br />Predicted risk: 0.342232088","Outcome category: 1<br />Score:  61<br />Predicted risk: 0.325627510","Outcome category: 1<br />Score:  62<br />Predicted risk: 0.309449550","Outcome category: 1<br />Score:  63<br />Predicted risk: 0.293725269","Outcome category: 1<br />Score:  64<br />Predicted risk: 0.278477781","Outcome category: 1<br />Score:  65<br />Predicted risk: 0.263726249","Outcome category: 1<br />Score:  66<br />Predicted risk: 0.249485938","Outcome category: 1<br />Score:  67<br />Predicted risk: 0.235768331","Outcome category: 1<br />Score:  68<br />Predicted risk: 0.222581278","Outcome category: 1<br />Score:  69<br />Predicted risk: 0.209929199","Outcome category: 1<br />Score:  70<br />Predicted risk: 0.197813302","Outcome category: 1<br />Score:  71<br />Predicted risk: 0.186231838","Outcome category: 1<br />Score:  72<br />Predicted risk: 0.175180364","Outcome category: 1<br />Score:  73<br />Predicted risk: 0.164652019","Outcome category: 1<br />Score:  74<br />Predicted risk: 0.154637798","Outcome category: 1<br />Score:  75<br />Predicted risk: 0.145126833","Outcome category: 1<br />Score:  76<br />Predicted risk: 0.136106654","Outcome category: 1<br />Score:  77<br />Predicted risk: 0.127563456","Outcome category: 1<br />Score:  78<br />Predicted risk: 0.119482335","Outcome category: 1<br />Score:  79<br />Predicted risk: 0.111847520","Outcome category: 1<br />Score:  80<br />Predicted risk: 0.104642585","Outcome category: 1<br />Score:  81<br />Predicted risk: 0.097850640","Outcome category: 1<br />Score:  82<br />Predicted risk: 0.091454505","Outcome category: 1<br />Score:  83<br />Predicted risk: 0.085436867","Outcome category: 1<br />Score:  84<br />Predicted risk: 0.079780416","Outcome category: 1<br />Score:  85<br />Predicted risk: 0.074467964","Outcome category: 1<br />Score:  86<br />Predicted risk: 0.069482549","Outcome category: 1<br />Score:  87<br />Predicted risk: 0.064807523","Outcome category: 1<br />Score:  88<br />Predicted risk: 0.060426623","Outcome category: 1<br />Score:  89<br />Predicted risk: 0.056324029","Outcome category: 1<br />Score:  90<br />Predicted risk: 0.052484417","Outcome category: 1<br />Score:  91<br />Predicted risk: 0.048892990","Outcome category: 1<br />Score:  92<br />Predicted risk: 0.045535509","Outcome category: 1<br />Score:  93<br />Predicted risk: 0.042398307","Outcome category: 1<br />Score:  94<br />Predicted risk: 0.039468308","Outcome category: 1<br />Score:  95<br />Predicted risk: 0.036733024","Outcome category: 1<br />Score:  96<br />Predicted risk: 0.034180559","Outcome category: 1<br />Score:  97<br />Predicted risk: 0.031799601","Outcome category: 1<br />Score:  98<br />Predicted risk: 0.029579417","Outcome category: 1<br />Score:  99<br />Predicted risk: 0.027509838","Outcome category: 1<br />Score: 100<br />Predicted risk: 0.025581243"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.0159233673666118,0.0171223297556443,0.0184086747439061,0.019788316411585,0.0212674975390309,0.0228527962703565,0.0245511307484305,0.0263697612637737,0.0283162893996802,0.0303986535917737,0.0326251204527944,0.0350042711436565,0.0375449820010132,0.0402563985614686,0.043147902055459,0.0462290673825219,0.049509611527712,0.0529993313405379,0.0567080295779916,0.0606454281178388,0.0648210672839067,0.0692441902989613,0.0739236120007752,0.0788675711314328,0.084083565747087,0.0895781716032619,0.0953568437564059,0.101423702091214,0.107781302038334,0.11443039238823,0.121369662829712,0.128595484636228,0.136101648773547,0.143879106585999,0.151915719104717,0.160196021872484,0.168701012950759,0.177407972414518,0.186290322094549,0.195317534538343,0.204455100075391,0.213664560441778,0.222903616604629,0.232126317205745,0.241283332411609,0.250322315931929,0.259188355593468,0.267824510197626,0.276172427539622,0.284173035534797,0.291767295508452,0.298897003992123,0.305505626963282,0.311539148490456,0.316946914308509,0.321682450033129,0.325704233585283,0.328976401960337,0.331469373736089,0.333160370631855,0.334033823942216,0.33408165468551,0.333303419721033,0.331706319778244,0.329305069174757,0.326121630841235,0.322184823984215,0.317529815170049,0.312197506681417,0.306233838572682,0.299689022840692,0.29261672946578,0.285073244723066,0.277116622106385,0.268805845467568,0.260200022604618,0.251357625614467,0.242335791963835,0.233189697547143,0.223972010124792,0.214732428601166,0.205517310735726,0.196369389194904,0.187327573440535,0.178426832882323,0.169698155042899,0.161168571215077,0.152861241230397,0.144795588484492,0.13698747624181,0.129449416422133,0.122190802500167,0.115218158770884,0.108535398991818,0.102144088257864,0.0960437028483668,0.0902318836718874,0.0847046797896678,0.0794567793008129,0.0744817256038718,0.0697721177004055],"text":["Outcome category: 2<br />Score:   0<br />Predicted risk: 0.015923367","Outcome category: 2<br />Score:   1<br />Predicted risk: 0.017122330","Outcome category: 2<br />Score:   2<br />Predicted risk: 0.018408675","Outcome category: 2<br />Score:   3<br />Predicted risk: 0.019788316","Outcome category: 2<br />Score:   4<br />Predicted risk: 0.021267498","Outcome category: 2<br />Score:   5<br />Predicted risk: 0.022852796","Outcome category: 2<br />Score:   6<br />Predicted risk: 0.024551131","Outcome category: 2<br />Score:   7<br />Predicted risk: 0.026369761","Outcome category: 2<br />Score:   8<br />Predicted risk: 0.028316289","Outcome category: 2<br />Score:   9<br />Predicted risk: 0.030398654","Outcome category: 2<br />Score:  10<br />Predicted risk: 0.032625120","Outcome category: 2<br />Score:  11<br />Predicted risk: 0.035004271","Outcome category: 2<br />Score:  12<br />Predicted risk: 0.037544982","Outcome category: 2<br />Score:  13<br />Predicted risk: 0.040256399","Outcome category: 2<br />Score:  14<br />Predicted risk: 0.043147902","Outcome category: 2<br />Score:  15<br />Predicted risk: 0.046229067","Outcome category: 2<br />Score:  16<br />Predicted risk: 0.049509612","Outcome category: 2<br />Score:  17<br />Predicted risk: 0.052999331","Outcome category: 2<br />Score:  18<br />Predicted risk: 0.056708030","Outcome category: 2<br />Score:  19<br />Predicted risk: 0.060645428","Outcome category: 2<br />Score:  20<br />Predicted risk: 0.064821067","Outcome category: 2<br />Score:  21<br />Predicted risk: 0.069244190","Outcome category: 2<br />Score:  22<br />Predicted risk: 0.073923612","Outcome category: 2<br />Score:  23<br />Predicted risk: 0.078867571","Outcome category: 2<br />Score:  24<br />Predicted risk: 0.084083566","Outcome category: 2<br />Score:  25<br />Predicted risk: 0.089578172","Outcome category: 2<br />Score:  26<br />Predicted risk: 0.095356844","Outcome category: 2<br />Score:  27<br />Predicted risk: 0.101423702","Outcome category: 2<br />Score:  28<br />Predicted risk: 0.107781302","Outcome category: 2<br />Score:  29<br />Predicted risk: 0.114430392","Outcome category: 2<br />Score:  30<br />Predicted risk: 0.121369663","Outcome category: 2<br />Score:  31<br />Predicted risk: 0.128595485","Outcome category: 2<br />Score:  32<br />Predicted risk: 0.136101649","Outcome category: 2<br />Score:  33<br />Predicted risk: 0.143879107","Outcome category: 2<br />Score:  34<br />Predicted risk: 0.151915719","Outcome category: 2<br />Score:  35<br />Predicted risk: 0.160196022","Outcome category: 2<br />Score:  36<br />Predicted risk: 0.168701013","Outcome category: 2<br />Score:  37<br />Predicted risk: 0.177407972","Outcome category: 2<br />Score:  38<br />Predicted risk: 0.186290322","Outcome category: 2<br />Score:  39<br />Predicted risk: 0.195317535","Outcome category: 2<br />Score:  40<br />Predicted risk: 0.204455100","Outcome category: 2<br />Score:  41<br />Predicted risk: 0.213664560","Outcome category: 2<br />Score:  42<br />Predicted risk: 0.222903617","Outcome category: 2<br />Score:  43<br />Predicted risk: 0.232126317","Outcome category: 2<br />Score:  44<br />Predicted risk: 0.241283332","Outcome category: 2<br />Score:  45<br />Predicted risk: 0.250322316","Outcome category: 2<br />Score:  46<br />Predicted risk: 0.259188356","Outcome category: 2<br />Score:  47<br />Predicted risk: 0.267824510","Outcome category: 2<br />Score:  48<br />Predicted risk: 0.276172428","Outcome category: 2<br />Score:  49<br />Predicted risk: 0.284173036","Outcome category: 2<br />Score:  50<br />Predicted risk: 0.291767296","Outcome category: 2<br />Score:  51<br />Predicted risk: 0.298897004","Outcome category: 2<br />Score:  52<br />Predicted risk: 0.305505627","Outcome category: 2<br />Score:  53<br />Predicted risk: 0.311539148","Outcome category: 2<br />Score:  54<br />Predicted risk: 0.316946914","Outcome category: 2<br />Score:  55<br />Predicted risk: 0.321682450","Outcome category: 2<br />Score:  56<br />Predicted risk: 0.325704234","Outcome category: 2<br />Score:  57<br />Predicted risk: 0.328976402","Outcome category: 2<br />Score:  58<br />Predicted risk: 0.331469374","Outcome category: 2<br />Score:  59<br />Predicted risk: 0.333160371","Outcome category: 2<br />Score:  60<br />Predicted risk: 0.334033824","Outcome category: 2<br />Score:  61<br />Predicted risk: 0.334081655","Outcome category: 2<br />Score:  62<br />Predicted risk: 0.333303420","Outcome category: 2<br />Score:  63<br />Predicted risk: 0.331706320","Outcome category: 2<br />Score:  64<br />Predicted risk: 0.329305069","Outcome category: 2<br />Score:  65<br />Predicted risk: 0.326121631","Outcome category: 2<br />Score:  66<br />Predicted risk: 0.322184824","Outcome category: 2<br />Score:  67<br />Predicted risk: 0.317529815","Outcome category: 2<br />Score:  68<br />Predicted risk: 0.312197507","Outcome category: 2<br />Score:  69<br />Predicted risk: 0.306233839","Outcome category: 2<br />Score:  70<br />Predicted risk: 0.299689023","Outcome category: 2<br />Score:  71<br />Predicted risk: 0.292616729","Outcome category: 2<br />Score:  72<br />Predicted risk: 0.285073245","Outcome category: 2<br />Score:  73<br />Predicted risk: 0.277116622","Outcome category: 2<br />Score:  74<br />Predicted risk: 0.268805845","Outcome category: 2<br />Score:  75<br />Predicted risk: 0.260200023","Outcome category: 2<br />Score:  76<br />Predicted risk: 0.251357626","Outcome category: 2<br />Score:  77<br />Predicted risk: 0.242335792","Outcome category: 2<br />Score:  78<br />Predicted risk: 0.233189698","Outcome category: 2<br />Score:  79<br />Predicted risk: 0.223972010","Outcome category: 2<br />Score:  80<br />Predicted risk: 0.214732429","Outcome category: 2<br />Score:  81<br />Predicted risk: 0.205517311","Outcome category: 2<br />Score:  82<br />Predicted risk: 0.196369389","Outcome category: 2<br />Score:  83<br />Predicted risk: 0.187327573","Outcome category: 2<br />Score:  84<br />Predicted risk: 0.178426833","Outcome category: 2<br />Score:  85<br />Predicted risk: 0.169698155","Outcome category: 2<br />Score:  86<br />Predicted risk: 0.161168571","Outcome category: 2<br />Score:  87<br />Predicted risk: 0.152861241","Outcome category: 2<br />Score:  88<br />Predicted risk: 0.144795588","Outcome category: 2<br />Score:  89<br />Predicted risk: 0.136987476","Outcome category: 2<br />Score:  90<br />Predicted risk: 0.129449416","Outcome category: 2<br />Score:  91<br />Predicted risk: 0.122190803","Outcome category: 2<br />Score:  92<br />Predicted risk: 0.115218159","Outcome category: 2<br />Score:  93<br />Predicted risk: 0.108535399","Outcome category: 2<br />Score:  94<br />Predicted risk: 0.102144088","Outcome category: 2<br />Score:  95<br />Predicted risk: 0.096043703","Outcome category: 2<br />Score:  96<br />Predicted risk: 0.090231884","Outcome category: 2<br />Score:  97<br />Predicted risk: 0.084704680","Outcome category: 2<br />Score:  98<br />Predicted risk: 0.079456779","Outcome category: 2<br />Score:  99<br />Predicted risk: 0.074481726","Outcome category: 2<br />Score: 100<br />Predicted risk: 0.069772118"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.00539650842628858,0.00581243364927353,0.00626021371680252,0.00674225606203505,0.00726114490634799,0.00781965341672064,0.00842075656559738,0.00906764471130883,0.00976373791322238,0.0105127009908615,0.0113184593301104,0.0121852154321189,0.0131174661914408,0.0141200208790511,0.0151980197929331,0.0163569535236567,0.0176026827644625,0.0189414585745443,0.0203799429801288,0.0219252297702731,0.0235848653126821,0.0253668691789589,0.0272797543282349,0.0293325465527845,0.0315348028388115,0.0338966282399413,0.0364286908000476,0.0391422339960112,0.0420490861001703,0.0451616657871535,0.0484929832313705,0.0520566358609216,0.0558667978527893,0.0599382023751003,0.0642861155078315,0.0689263007070421,0.0738749726237853,0.0791487390522397,0.0847645297681029,0.0907395110344169,0.0970909846049754,0.10383627015304,0.110992570203346,0.118576816856321,0.126605499872692,0.135094476040705,0.14405876018197,0.153512298667676,0.163467726913705,0.173936112995496,0.184926690260915,0.196446582605166,0.208500526882722,0.221090597737186,0.234215940894001,0.247872521640086,0.262052895761411,0.27674601057424,0.291937043819117,0.307607288043271,0.323734087639828,0.340290834916324,0.357247030421905,0.374568411283651,0.392217149520906,0.410152120278486,0.428329237722825,0.446701854075895,0.465221215029412,0.483836962702521,0.502497675493754,0.521151432736436,0.539746391080904,0.558231359056213,0.576556356337321,0.59467314485635,0.612535720011363,0.630100751776158,0.647327967409173,0.664180469591279,0.680624986075641,0.696632049192993,0.712176105716054,0.727235559555599,0.741792751465874,0.755833881328399,0.769348879633651,0.782331235483827,0.794777788810122,0.806688494563289,0.818066166436269,0.828916207259326,0.839246332620919,0.849066293561236,0.858387603406065,0.867223272998095,0.875587557775834,0.883495719375516,0.890963803710011,0.898008436825844,0.904646639263998],"text":["Outcome category: 3<br />Score:   0<br />Predicted risk: 0.005396508","Outcome category: 3<br />Score:   1<br />Predicted risk: 0.005812434","Outcome category: 3<br />Score:   2<br />Predicted risk: 0.006260214","Outcome category: 3<br />Score:   3<br />Predicted risk: 0.006742256","Outcome category: 3<br />Score:   4<br />Predicted risk: 0.007261145","Outcome category: 3<br />Score:   5<br />Predicted risk: 0.007819653","Outcome category: 3<br />Score:   6<br />Predicted risk: 0.008420757","Outcome category: 3<br />Score:   7<br />Predicted risk: 0.009067645","Outcome category: 3<br />Score:   8<br />Predicted risk: 0.009763738","Outcome category: 3<br />Score:   9<br />Predicted risk: 0.010512701","Outcome category: 3<br />Score:  10<br />Predicted risk: 0.011318459","Outcome category: 3<br />Score:  11<br />Predicted risk: 0.012185215","Outcome category: 3<br />Score:  12<br />Predicted risk: 0.013117466","Outcome category: 3<br />Score:  13<br />Predicted risk: 0.014120021","Outcome category: 3<br />Score:  14<br />Predicted risk: 0.015198020","Outcome category: 3<br />Score:  15<br />Predicted risk: 0.016356954","Outcome category: 3<br />Score:  16<br />Predicted risk: 0.017602683","Outcome category: 3<br />Score:  17<br />Predicted risk: 0.018941459","Outcome category: 3<br />Score:  18<br />Predicted risk: 0.020379943","Outcome category: 3<br />Score:  19<br />Predicted risk: 0.021925230","Outcome category: 3<br />Score:  20<br />Predicted risk: 0.023584865","Outcome category: 3<br />Score:  21<br />Predicted risk: 0.025366869","Outcome category: 3<br />Score:  22<br />Predicted risk: 0.027279754","Outcome category: 3<br />Score:  23<br />Predicted risk: 0.029332547","Outcome category: 3<br />Score:  24<br />Predicted risk: 0.031534803","Outcome category: 3<br />Score:  25<br />Predicted risk: 0.033896628","Outcome category: 3<br />Score:  26<br />Predicted risk: 0.036428691","Outcome category: 3<br />Score:  27<br />Predicted risk: 0.039142234","Outcome category: 3<br />Score:  28<br />Predicted risk: 0.042049086","Outcome category: 3<br />Score:  29<br />Predicted risk: 0.045161666","Outcome category: 3<br />Score:  30<br />Predicted risk: 0.048492983","Outcome category: 3<br />Score:  31<br />Predicted risk: 0.052056636","Outcome category: 3<br />Score:  32<br />Predicted risk: 0.055866798","Outcome category: 3<br />Score:  33<br />Predicted risk: 0.059938202","Outcome category: 3<br />Score:  34<br />Predicted risk: 0.064286116","Outcome category: 3<br />Score:  35<br />Predicted risk: 0.068926301","Outcome category: 3<br />Score:  36<br />Predicted risk: 0.073874973","Outcome category: 3<br />Score:  37<br />Predicted risk: 0.079148739","Outcome category: 3<br />Score:  38<br />Predicted risk: 0.084764530","Outcome category: 3<br />Score:  39<br />Predicted risk: 0.090739511","Outcome category: 3<br />Score:  40<br />Predicted risk: 0.097090985","Outcome category: 3<br />Score:  41<br />Predicted risk: 0.103836270","Outcome category: 3<br />Score:  42<br />Predicted risk: 0.110992570","Outcome category: 3<br />Score:  43<br />Predicted risk: 0.118576817","Outcome category: 3<br />Score:  44<br />Predicted risk: 0.126605500","Outcome category: 3<br />Score:  45<br />Predicted risk: 0.135094476","Outcome category: 3<br />Score:  46<br />Predicted risk: 0.144058760","Outcome category: 3<br />Score:  47<br />Predicted risk: 0.153512299","Outcome category: 3<br />Score:  48<br />Predicted risk: 0.163467727","Outcome category: 3<br />Score:  49<br />Predicted risk: 0.173936113","Outcome category: 3<br />Score:  50<br />Predicted risk: 0.184926690","Outcome category: 3<br />Score:  51<br />Predicted risk: 0.196446583","Outcome category: 3<br />Score:  52<br />Predicted risk: 0.208500527","Outcome category: 3<br />Score:  53<br />Predicted risk: 0.221090598","Outcome category: 3<br />Score:  54<br />Predicted risk: 0.234215941","Outcome category: 3<br />Score:  55<br />Predicted risk: 0.247872522","Outcome category: 3<br />Score:  56<br />Predicted risk: 0.262052896","Outcome category: 3<br />Score:  57<br />Predicted risk: 0.276746011","Outcome category: 3<br />Score:  58<br />Predicted risk: 0.291937044","Outcome category: 3<br />Score:  59<br />Predicted risk: 0.307607288","Outcome category: 3<br />Score:  60<br />Predicted risk: 0.323734088","Outcome category: 3<br />Score:  61<br />Predicted risk: 0.340290835","Outcome category: 3<br />Score:  62<br />Predicted risk: 0.357247030","Outcome category: 3<br />Score:  63<br />Predicted risk: 0.374568411","Outcome category: 3<br />Score:  64<br />Predicted risk: 0.392217150","Outcome category: 3<br />Score:  65<br />Predicted risk: 0.410152120","Outcome category: 3<br />Score:  66<br />Predicted risk: 0.428329238","Outcome category: 3<br />Score:  67<br />Predicted risk: 0.446701854","Outcome category: 3<br />Score:  68<br />Predicted risk: 0.465221215","Outcome category: 3<br />Score:  69<br />Predicted risk: 0.483836963","Outcome category: 3<br />Score:  70<br />Predicted risk: 0.502497675","Outcome category: 3<br />Score:  71<br />Predicted risk: 0.521151433","Outcome category: 3<br />Score:  72<br />Predicted risk: 0.539746391","Outcome category: 3<br />Score:  73<br />Predicted risk: 0.558231359","Outcome category: 3<br />Score:  74<br />Predicted risk: 0.576556356","Outcome category: 3<br />Score:  75<br />Predicted risk: 0.594673145","Outcome category: 3<br />Score:  76<br />Predicted risk: 0.612535720","Outcome category: 3<br />Score:  77<br />Predicted risk: 0.630100752","Outcome category: 3<br />Score:  78<br />Predicted risk: 0.647327967","Outcome category: 3<br />Score:  79<br />Predicted risk: 0.664180470","Outcome category: 3<br />Score:  80<br />Predicted risk: 0.680624986","Outcome category: 3<br />Score:  81<br />Predicted risk: 0.696632049","Outcome category: 3<br />Score:  82<br />Predicted risk: 0.712176106","Outcome category: 3<br />Score:  83<br />Predicted risk: 0.727235560","Outcome category: 3<br />Score:  84<br />Predicted risk: 0.741792751","Outcome category: 3<br />Score:  85<br />Predicted risk: 0.755833881","Outcome category: 3<br />Score:  86<br />Predicted risk: 0.769348880","Outcome category: 3<br />Score:  87<br />Predicted risk: 0.782331235","Outcome category: 3<br />Score:  88<br />Predicted risk: 0.794777789","Outcome category: 3<br />Score:  89<br />Predicted risk: 0.806688495","Outcome category: 3<br />Score:  90<br />Predicted risk: 0.818066166","Outcome category: 3<br />Score:  91<br />Predicted risk: 0.828916207","Outcome category: 3<br />Score:  92<br />Predicted risk: 0.839246333","Outcome category: 3<br />Score:  93<br />Predicted risk: 0.849066294","Outcome category: 3<br />Score:  94<br />Predicted risk: 0.858387603","Outcome category: 3<br />Score:  95<br />Predicted risk: 0.867223273","Outcome category: 3<br />Score:  96<br />Predicted risk: 0.875587558","Outcome category: 3<br />Score:  97<br />Predicted risk: 0.883495719","Outcome category: 3<br />Score:  98<br />Predicted risk: 0.890963804","Outcome category: 3<br />Score:  99<br />Predicted risk: 0.898008437","Outcome category: 3<br />Score: 100<br />Predicted risk: 0.904646639"],"type":"scatter","mode":"lines+markers","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":3.77952755905512,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,76,89],"y":[0.00025,0.0005,0.001,0.0025,0.003,0.00325,0.0035,0.0095,0.00975,0.014,0.004,0.005,0.00925,0.0085,0.01125,0.00875,0.02075,0.03825,0.0335,0.05825,0.01225,0.0285,0.043,0.0325,0.05875,0.02125,0.03825,0.0425,0.02625,0.05125,0.0275,0.02625,0.0335,0.022,0.02675,0.0185,0.02125,0.02575,0.0135,0.02325,0.017,0.0145,0.011,0.01225,0.01125,0.01175,0.01,0.00825,0.0065,0.0065,0.008,0.005,0.005,0.005,0.004,0.0035,0.00325,0.0025,0.002,0.00225,0.00125,0.00225,0.002,0.001,0.00075,0.00075,0.001,0.00075,0.00025,0.00075,0.00025,0.0005,0.00075,0.00025,0.00025,0.00025],"text":["Score:  0<br />Proportion: 0.00025","Score:  1<br />Proportion: 0.00050","Score:  2<br />Proportion: 0.00100","Score:  3<br />Proportion: 0.00250","Score:  4<br />Proportion: 0.00300","Score:  5<br />Proportion: 0.00325","Score:  6<br />Proportion: 0.00350","Score:  7<br />Proportion: 0.00950","Score:  8<br />Proportion: 0.00975","Score:  9<br />Proportion: 0.01400","Score: 10<br />Proportion: 0.00400","Score: 11<br />Proportion: 0.00500","Score: 12<br />Proportion: 0.00925","Score: 13<br />Proportion: 0.00850","Score: 14<br />Proportion: 0.01125","Score: 15<br />Proportion: 0.00875","Score: 16<br />Proportion: 0.02075","Score: 17<br />Proportion: 0.03825","Score: 18<br />Proportion: 0.03350","Score: 19<br />Proportion: 0.05825","Score: 20<br />Proportion: 0.01225","Score: 21<br />Proportion: 0.02850","Score: 22<br />Proportion: 0.04300","Score: 23<br />Proportion: 0.03250","Score: 24<br />Proportion: 0.05875","Score: 25<br />Proportion: 0.02125","Score: 26<br />Proportion: 0.03825","Score: 27<br />Proportion: 0.04250","Score: 28<br />Proportion: 0.02625","Score: 29<br />Proportion: 0.05125","Score: 30<br />Proportion: 0.02750","Score: 31<br />Proportion: 0.02625","Score: 32<br />Proportion: 0.03350","Score: 33<br />Proportion: 0.02200","Score: 34<br />Proportion: 0.02675","Score: 35<br />Proportion: 0.01850","Score: 36<br />Proportion: 0.02125","Score: 37<br />Proportion: 0.02575","Score: 38<br />Proportion: 0.01350","Score: 39<br />Proportion: 0.02325","Score: 40<br />Proportion: 0.01700","Score: 41<br />Proportion: 0.01450","Score: 42<br />Proportion: 0.01100","Score: 43<br />Proportion: 0.01225","Score: 44<br />Proportion: 0.01125","Score: 45<br />Proportion: 0.01175","Score: 46<br />Proportion: 0.01000","Score: 47<br />Proportion: 0.00825","Score: 48<br />Proportion: 0.00650","Score: 49<br />Proportion: 0.00650","Score: 50<br />Proportion: 0.00800","Score: 51<br />Proportion: 0.00500","Score: 52<br />Proportion: 0.00500","Score: 53<br />Proportion: 0.00500","Score: 54<br />Proportion: 0.00400","Score: 55<br />Proportion: 0.00350","Score: 56<br />Proportion: 0.00325","Score: 57<br />Proportion: 0.00250","Score: 58<br />Proportion: 0.00200","Score: 59<br />Proportion: 0.00225","Score: 60<br />Proportion: 0.00125","Score: 61<br />Proportion: 0.00225","Score: 62<br />Proportion: 0.00200","Score: 63<br />Proportion: 0.00100","Score: 64<br />Proportion: 0.00075","Score: 65<br />Proportion: 0.00075","Score: 66<br />Proportion: 0.00100","Score: 67<br />Proportion: 0.00075","Score: 68<br />Proportion: 0.00025","Score: 69<br />Proportion: 0.00075","Score: 70<br />Proportion: 0.00025","Score: 71<br />Proportion: 0.00050","Score: 72<br />Proportion: 0.00075","Score: 73<br />Proportion: 0.00025","Score: 76<br />Proportion: 0.00025","Score: 89<br />Proportion: 0.00025"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5,105],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.9402241594022},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(229,229,229,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"xaxis2":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5,105],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.9402241594022},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(229,229,229,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":{"text":"Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.205714285714286],"automargin":true,"type":"linear","autorange":false,"range":[-0.0029375,0.0616875],"tickmode":"array","ticktext":["0.00","0.02","0.04","0.06"],"tickvals":[0,0.02,0.04,0.06],"categoryorder":"array","categoryarray":["0.00","0.02","0.04","0.06"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.9402241594022},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(229,229,229,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x2","title":{"text":"Proportion<br />of subjects","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0.365714285714286,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15.9402241594022},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":true,"gridcolor":"rgba(229,229,229,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Predicted risk","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.365714285714286,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.205714285714286}],"images":[],"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":44.4333748443338,"l":57.4512245745123},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Points indicate attainable final scores","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Outcome category","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"attrs":{"ce22271290bf":{"colour":{},"x":{},"y":{},"type":"scatter"},"ce2233dcffa3":{"colour":{},"x":{},"y":{}},"ce2276cb60e3":{"x":{},"y":{},"type":"bar"}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li>Given the proportion of subjects for each score value (see figure above), select reasonable score breaks (Default: 5, 10, 15, …, 70) to report the average predicted risk within each score interval, which can be used to predict risk for a new subject.</li>
<li>When selecting score breaks, avoid creating score intervals with too few observations.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conversion_table_ordinal</span>(<span class="at">pred_score =</span> pred_score, <span class="at">link =</span> link,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">score_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">5</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="dv">5</span>), </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Score</th>
<th style="text-align: right;">Predicted risk, category 1</th>
<th style="text-align: right;">Predicted risk, category 2</th>
<th style="text-align: right;">Predicted risk, category 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">[0,5]</td>
<td style="text-align: right;">0.9742</td>
<td style="text-align: right;">0.0192</td>
<td style="text-align: right;">0.0065</td>
</tr>
<tr class="even">
<td style="text-align: left;">(5,10]</td>
<td style="text-align: right;">0.9617</td>
<td style="text-align: right;">0.0285</td>
<td style="text-align: right;">0.0098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(10,15]</td>
<td style="text-align: right;">0.9454</td>
<td style="text-align: right;">0.0404</td>
<td style="text-align: right;">0.0142</td>
</tr>
<tr class="even">
<td style="text-align: left;">(15,20]</td>
<td style="text-align: right;">0.9226</td>
<td style="text-align: right;">0.0569</td>
<td style="text-align: right;">0.0205</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(20,25]</td>
<td style="text-align: right;">0.8914</td>
<td style="text-align: right;">0.0791</td>
<td style="text-align: right;">0.0295</td>
</tr>
<tr class="even">
<td style="text-align: left;">(25,30]</td>
<td style="text-align: right;">0.8497</td>
<td style="text-align: right;">0.1081</td>
<td style="text-align: right;">0.0423</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(30,35]</td>
<td style="text-align: right;">0.7956</td>
<td style="text-align: right;">0.1441</td>
<td style="text-align: right;">0.0602</td>
</tr>
<tr class="even">
<td style="text-align: left;">(35,40]</td>
<td style="text-align: right;">0.7284</td>
<td style="text-align: right;">0.1864</td>
<td style="text-align: right;">0.0851</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(40,45]</td>
<td style="text-align: right;">0.6489</td>
<td style="text-align: right;">0.2321</td>
<td style="text-align: right;">0.1190</td>
</tr>
<tr class="even">
<td style="text-align: left;">(45,50]</td>
<td style="text-align: right;">0.5602</td>
<td style="text-align: right;">0.2758</td>
<td style="text-align: right;">0.1640</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(50,55]</td>
<td style="text-align: right;">0.4675</td>
<td style="text-align: right;">0.3109</td>
<td style="text-align: right;">0.2216</td>
</tr>
<tr class="even">
<td style="text-align: left;">(55,60]</td>
<td style="text-align: right;">0.3769</td>
<td style="text-align: right;">0.3307</td>
<td style="text-align: right;">0.2924</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(60,65]</td>
<td style="text-align: right;">0.2942</td>
<td style="text-align: right;">0.3309</td>
<td style="text-align: right;">0.3749</td>
</tr>
<tr class="even">
<td style="text-align: left;">(65,70]</td>
<td style="text-align: right;">0.2231</td>
<td style="text-align: right;">0.3116</td>
<td style="text-align: right;">0.4653</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(70,100]</td>
<td style="text-align: right;">0.0840</td>
<td style="text-align: right;">0.1718</td>
<td style="text-align: right;">0.7442</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>pred_score</code> for further analysis or export it to CSV to other software (e.g., generating the calibration curve).</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(pred_score, <span class="at">file =</span> <span class="st">"pred_score.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="demo2" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="demo2"><span class="header-section-number">6.2</span> Demo 2: small sample</h2>
<p>In Demo 2, we demonstrate the use of AutoScore-Ordinal on a smaller dataset where there are no sufficient samples to form a separate training and validation dataset. Thus, the cross validation is employed to generate the parsimony plot.</p>
<p class="p-h3">
Load small dataset with 5000 samples
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sample_data_ordinal_small"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p class="p-h3">
Prepare training and test datasets
</p>
<ul>
<li>Option 1: Prepare two separate datasets to train and test models.</li>
<li>Option 2: Use demo codes below to randomly split your dataset into training and test datasets (70% and 30%, respectively). For cross-validation, <code>train_set</code> is equal to <code>validation_set</code> and the ratio of <code>validation_set</code> should be 0. Then cross-validation will be implemented in the STEP(ii), <code>AutoScore_parsimony_Ordinal()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_ordinal_small, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cross_validation =</span> <span class="cn">TRUE</span>, <span class="at">strat_by_label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stepi-generate-variable-ranking-list-1" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="stepi-generate-variable-ranking-list-1"><span class="header-section-number">6.2.1</span> STEP(i): generate variable ranking list</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 1
</p>
<ul>
<li>Variables are ranked by random forest for multiclass classification.</li>
<li><code>ntree</code>: Number of trees in the random forest algorithm (Default: 100).</li>
</ul>
<div class="cell" data-hash="06-autoscore_ordinal_cache/html/rank_ord_small_c41315c28a247a39f2f62a0bd2794d13">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Ordinal</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ranking based on variable importance was shown below for each variable: 
      Age     Lab_A    Util_D   Vital_A   Vital_F   Vital_E   Vital_D     Lab_B 
98.791839 98.073161 97.021662 93.282141 92.469166 91.677271 82.051893 72.462999 
    Lab_C    Util_B    Util_C   Vital_C   Vital_B    Util_A  Comorb_A    Gender 
70.507041 57.778464 57.270171 45.468903 43.633031 26.120379 25.414958 13.405373 
 Comorb_B  Comorb_D  Comorb_C  Comorb_E 
 9.595971  7.320633  4.477519  2.993603 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/rank_ord_small-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stepii-select-the-best-model-with-parsimony-plot" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="stepii-select-the-best-model-with-parsimony-plot"><span class="header-section-number">6.2.2</span> STEP(ii): select the best model with parsimony plot</h3>
<p class="autoscore-module">
AutoScore-Ordinal Modules 2+3+4
</p>
<ul>
<li><code>nmin</code>: Minimum number of selected variables (Default: 1).</li>
<li><code>nmax</code>: Maximum number of selected variables (Default: 20).</li>
<li><code>categorize</code>: Methods for categorizing continuous variables. Options include <code>"quantile"</code> or <code>"kmeans"</code> (Default: <code>"quantile"</code>).</li>
<li><code>quantiles</code>: Predefined quantiles to convert continuous variables to categorical ones. (Default: <code>c(0, 0.05, 0.2, 0.8, 0.95, 1)</code>) Available if <code>categorize = "quantile"</code>.</li>
<li><code>max_cluster</code>: The maximum number of cluster (Default: 5). Available if <code>categorize = "kmeans"</code>.</li>
<li><code>max_score</code>: Maximum total score (Default: 100).</li>
<li><code>auc_lim_min</code>: Minimum y_axis limit in the parsimony plot (Default: 0.5).</li>
<li><code>auc_lim_max</code>: Maximum y_axis limit in the parsimony plot (Default: “adaptive”).</li>
<li><code>cross_validation</code>: <code>TRUE</code> if cross-validation is needed, especially for small datasets.</li>
<li><code>fold</code>: The number of folds used in cross validation (Default: 10). Available if <code>cross_validation = TRUE</code>.</li>
<li><code>do_trace</code>: If set to <code>TRUE</code>, all results based on each fold of cross-validation would be printed out and plotted (Default: <code>FALSE</code>). Available if <code>cross_validation = TRUE</code>.</li>
<li><code>link</code>: link function in the ordinal regression, which affects predictive performance. Options include <code>"logit"</code> (for proportional odds model), <code>"cloglog"</code> (for proportional hazard model) and <code>"probit"</code> (Default: <code>"logit"</code>).</li>
</ul>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Use the same <code>link</code> parameter throughout descriptive analysis and model building steps.</em></p>
</div>
</div>
<div class="cell" data-hash="06-autoscore_ordinal_cache/html/mauc_ord_small_427b067b93d533800136f47096dd46c1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>link <span class="ot">&lt;-</span> <span class="st">"logit"</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>mAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Ordinal</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, <span class="at">link =</span> link,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> ranking, <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="dv">0</span>, <span class="at">auc_lim_max =</span> <span class="st">"adaptive"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross_validation =</span> <span class="cn">TRUE</span>, <span class="at">fold =</span> <span class="dv">10</span>, <span class="at">do_trace =</span> <span class="cn">FALSE</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  Select 1 variables:  Select 2 variables:  Select 3 variables:  Select 4 variables:  Select 5 variables:  Select 6 variables:  Select 7 variables:  Select 8 variables:  Select 9 variables:  Select 10 variables:  Select 11 variables:  Select 12 variables:  Select 13 variables:  Select 14 variables:  Select 15 variables:  Select 16 variables:  Select 17 variables:  Select 18 variables:  Select 19 variables:  Select 20 variables:  ***list of fianl mean mAUC values through cross validation are shown below        mAUC
1  0.4373127
2  0.5706558
3  0.6276256
4  0.6361478
5  0.6398421
6  0.6279290
7  0.6349191
8  0.6341125
9  0.6298176
10 0.6928897
11 0.6937431
12 0.6811859
13 0.6803831
14 0.6877744
15 0.7371436
16 0.7366716
17 0.7362270
18 0.7368480
19 0.7362830
20 0.7373470</code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/mauc_ord_small-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>mAUC</code> for further analysis or export it to CSV to other software for plotting.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(mAUC), <span class="at">file =</span> <span class="st">"mAUC.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Determine the optimal number of variables (<code>num_var</code>) based on the parsimony plot obtained in STEP(ii).</li>
<li>The final list of variables is the first <code>num_var</code> variables in the ranked list <code>ranking</code> obtained in STEP(i).</li>
<li>Optional: User can adjust the finally included variables <code>final_variables</code> based on the clinical preferences and knowledge.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Top 6 variables are selected</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: Top 14 variables are selected</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: Top 3 variables, the 6th, 10th and 15th variable are selected</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stepiii-generate-initial-scores-with-final-variables-1" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="stepiii-generate-initial-scores-with-final-variables-1"><span class="header-section-number">6.2.3</span> STEP(iii): generate initial scores with final variables</h3>
<p class="autoscore-module">
Re-run AutoScore-Ordinal Modules 2+3
</p>
<ul>
<li>Generate <code>cut_vec</code> with current cutoffs of continuous variables, which can be fine-tuned in STEP(iv).</li>
<li>Performance of resulting scores is evaluated using the mean AUC across dichotomous classifications (mAUC), with 95% CI computed using bootstrap (Default: <code>n_boot = 100</code> bootstrap samples). Setting <code>n_boot = 1</code> disables bootstrap and reports mAUC without CI.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Ordinal</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">link =</span> link, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1           Age
2         Lab_A
3        Util_D
4       Vital_E
5        Util_B
6      Comorb_A
****Initial Scores: 


========  ===========  =====
variable  interval     point
========  ===========  =====
Age       &lt;27            0  
          [27,46)       11  
          [46,78)       19  
          [78,87)       25  
          &gt;=87          30  
                            
Lab_A     &lt;46           12  
          [46,61)        0  
          [61,136)       1  
          [136,608)      8  
          &gt;=608         10  
                            
Util_D    &lt;0.64          6  
          [0.64,1.3)     7  
          [1.3,3.83)     4  
          [3.83,5.74)    4  
          &gt;=5.74         0  
                            
Vital_E   &lt;98           10  
          [98,111)       5  
          [111,153)      1  
          [153,179)      0  
          &gt;=179          1  
                            
Util_B    &lt;1             0  
          [1,4)         10  
          &gt;=4           21  
                            
Comorb_A  0              0  
          1             20  
========  ===========  =====
***Performance (based on validation set):
mAUC: 0.7472     95% CI: 0.7307-0.7587 (from 10 bootstrap samples)
***The cutoffs of each variables generated by the AutoScore-Ordinal are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>
</section>
<section id="stepiv-fine-tune-initial-score-from-stepiii" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="stepiv-fine-tune-initial-score-from-stepiii"><span class="header-section-number">6.2.4</span> STEP(iv): fine-tune initial score from STEP(iii)</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 5 &amp; Re-run AutoScore-Ordinal Modules 2+3
</p>
<ul>
<li>Revise <code>cut_vec</code> with domain knowledge to update the scoring table (AutoScore-Ordinal Module 5).</li>
<li>Re-run AutoScore-Ordinal Modules 2+3 to generate the updated scores.</li>
<li>Users can choose any cutoff values and/or any number of categories, but are suggested to choose numbers close to the automatically determined values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For example, we have current cutoffs of continuous variable: Age </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">## variable        interval     point</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Age                 &lt;27          0  </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [27,46)      4  </span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [46,78)     14  </span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                     [78,87)     18 </span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                     &gt;=87        21 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Current cutoffs:<code>c(27, 46, 78, 87)</code>. We can fine tune the cutoffs as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: rounding to a nice number</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: changing cutoffs according to clinical knowledge or preference </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: combining categories</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>mAUC and 95% bootstrap CI (Default: <code>n_boot = 100</code> bootstrap samples) are reported after fine-tuning.</li>
<li>Run time increases with larger <code>n_boot</code> value. Code below uses <code>n_boot = 10</code> for demonstration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Util_D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">4</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">135</span>, <span class="dv">595</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">75</span>, <span class="dv">85</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Vital_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">95</span>, <span class="dv">115</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>scoring_table <span class="ot">&lt;-</span> <span class="fu">AutoScore_fine_tuning_Ordinal</span>(</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, <span class="at">link =</span> link,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">cut_vec =</span> cut_vec, <span class="at">max_score =</span> <span class="dv">100</span>, </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Fine-tuned Scores: 


========  ============  =====
variable  interval      point
========  ============  =====
Age       &lt;25             0  
          [25,45)         8  
          [45,75)        18  
          [75,85)        24  
          &gt;=85           27  
                             
Lab_A     &lt;45            12  
          [45,60)         0  
          [60,135)        1  
          [135,595)       8  
          &gt;=595           9  
                             
Util_D    &lt;0.667          6  
          [0.667,1.33)    8  
          [1.33,4)        3  
          [4,6)           5  
          &gt;=6             0  
                             
Vital_E   &lt;98            10  
          [98,111)        5  
          [111,153)       2  
          [153,179)       0  
          &gt;=179           1  
                             
Util_B    &lt;1              0  
          [1,4)           9  
          &gt;=4            22  
                             
Comorb_A  0               0  
          1              20  
========  ============  =====
***Performance (based on Validation Set, after fine-tuning):
mAUC: 0.7488     95% CI: 0.7414-0.7651 (from 10 bootstrap samples)</code></pre>
</div>
</div>
</section>
<section id="stepv-evaluate-final-risk-scores-on-test-dataset-1" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="stepv-evaluate-final-risk-scores-on-test-dataset-1"><span class="header-section-number">6.2.5</span> STEP(v): evaluate final risk scores on test dataset</h3>
<p class="autoscore-module">
AutoScore-Ordinal Module 6
</p>
<ul>
<li>mAUC and generalised c-index are reported for the test set, with 95% bootstrap CI (Default: <code>n_boot = 100</code> bootstrap samples).</li>
<li>Run time increases with larger <code>n_boot</code> value. Code below uses <code>n_boot = 10</code> for demonstration.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pred_score <span class="ot">&lt;-</span> <span class="fu">AutoScore_testing_Ordinal</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_set =</span> test_set, <span class="at">link =</span> link, <span class="at">final_variables =</span> final_variables, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cut_vec =</span> cut_vec, <span class="at">scoring_table =</span> scoring_table, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">with_label =</span> <span class="cn">TRUE</span>, <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Performance using AutoScore-Ordinal (based on unseen test Set):
mAUC: 0.7466     95% CI: 0.7295-0.7751 (from 10 bootstrap samples)
Generalised c-index: 0.7043      95% CI: 0.6914-0.7218 (from 10 bootstrap samples)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pred_score Label
1         23     1
2         35     1
3         56     1
4         32     1
5         19     1
6         17     1</code></pre>
</div>
</div>
</section>
<section id="map-score-to-risk" class="level3" data-number="6.2.6">
<h3 data-number="6.2.6" class="anchored" data-anchor-id="map-score-to-risk"><span class="header-section-number">6.2.6</span> Map score to risk</h3>
<ul>
<li>Users can also map score to risk using <code>plot_predicted_risk()</code> and <code>conversion_table_ordinal()</code>. Please refer to <a href="#demo1-map">our demo for large sample (6.1.6)</a> for detail.</li>
</ul>
</section>
</section>
<section id="demo-3-data-with-missing-values" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="demo-3-data-with-missing-values"><span class="header-section-number">6.3</span> Demo 3: data with missing values</h2>
<p>In Demo 3, we demonstrate AutoScore-Ordinal for application to data with missing values in two variables (i.e., <code>Lab_A</code> and <code>Vital_A</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_data_ordinal</span>(sample_data_ordinal_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data type check passed. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
WARNING: NA detected in data: -----</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Variable name No. missing %missing
Lab_A           Lab_A        4000       20
Vital_A       Vital_A       12000       60</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>SUGGESTED ACTION:
 * Consider imputation and supply AutoScore with complete data.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> * Alternatively, AutoScore can handle missing values as a separate 'Unknown' category, IF:
    - you believe the missingness in your dataset is informative, AND
    - missing is prevalent enough that you prefer to preserve them as NA rather than removing or doing imputation, AND
    - missing is not too prevalent, which may make results unstable.</code></pre>
</div>
</div>
<p>AutoScore can automatically treat the missingness as a new category named <code>Unknown</code>. The following steps are the <strong>same</strong> as those in <a href="#demo1">Demo 1 (5.1)</a>.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>High missing rate may cause the variable ranking less reliable, and thus, caution is needed for variable selection using parsimony plot.</em></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_ordinal_missing, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>), </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">strat_by_label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>link <span class="ot">&lt;-</span> <span class="st">"logit"</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Ordinal</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ranking based on variable importance was shown below for each variable: 
   Util_D   Vital_F       Age   Vital_E   Vital_D     Lab_A     Lab_B     Lab_C 
432.05170 395.23272 389.37997 388.54148 355.19859 351.72325 309.15289 293.42544 
   Util_C   Vital_A    Util_B   Vital_C   Vital_B  Comorb_A    Util_A    Gender 
250.03152 237.65460 204.70610 194.94617 175.67372 114.72640 104.22830  54.97728 
 Comorb_B  Comorb_D  Comorb_C  Comorb_E 
 40.84687  33.48135  18.00868  11.23225 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/missing_ord-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Ordinal</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, <span class="at">link =</span> link,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> ranking, <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="dv">0</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Select 1 variables:  Mean area under the curve: 0.4555607 
Select 2 variables:  Mean area under the curve: 0.5634823 
Select 3 variables:  Mean area under the curve: 0.6431742 
Select 4 variables:  Mean area under the curve: 0.6458002 
Select 5 variables:  Mean area under the curve: 0.6463306 
Select 6 variables:  Mean area under the curve: 0.6491724 
Select 7 variables:  Mean area under the curve: 0.6504178 
Select 8 variables:  Mean area under the curve: 0.6519616 
Select 9 variables:  Mean area under the curve: 0.6496988 
Select 10 variables:  Mean area under the curve: 0.6608109 
Select 11 variables:  Mean area under the curve: 0.6922967 
Select 12 variables:  Mean area under the curve: 0.6916261 
Select 13 variables:  Mean area under the curve: 0.6902582 
Select 14 variables:  Mean area under the curve: 0.7399622 
Select 15 variables:  Mean area under the curve: 0.7401835 
Select 16 variables:  Mean area under the curve: 0.7395909 
Select 17 variables:  Mean area under the curve: 0.7405369 
Select 18 variables:  Mean area under the curve: 0.7405267 
Select 19 variables:  Mean area under the curve: 0.740007 
Select 20 variables:  Mean area under the curve: 0.7397616 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="06-autoscore_ordinal_files/figure-html/missing_ord-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>The <code>Unknown</code> category indicating the missingness will be displayed in the final scoring table.</em></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">14</span>)])</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Ordinal</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">link =</span> link, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>), </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_boot =</span> <span class="dv">10</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1        Util_D
2       Vital_F
3           Age
4        Util_B
5      Comorb_A
****Initial Scores: 


========  ============  =====
variable  interval      point
========  ============  =====
Util_D    &lt;0.652          9  
          [0.652,1.32)    9  
          [1.32,3.93)     3  
          [3.93,5.93)     1  
          &gt;=5.93          0  
                             
Vital_F   &lt;16.7          10  
          [16.7,20.5)     4  
          [20.5,25.4)     0  
          [25.4,28.1)     1  
          &gt;=28.1          4  
                             
Age       &lt;27             0  
          [27,46)         4  
          [46,78)        17  
          [78,87)        22  
          &gt;=87           26  
                             
Util_B    &lt;1              0  
          [1,4)          13  
          &gt;=4            27  
                             
Comorb_A  0               0  
          1              28  
========  ============  =====
***Performance (based on validation set):
mAUC: 0.7201     95% CI: 0.6960-0.7296 (from 10 bootstrap samples)
***The cutoffs of each variables generated by the AutoScore-Ordinal are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./05-autoscore_survival.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AutoScore for survival outcomes (AutoScore-Survival)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>