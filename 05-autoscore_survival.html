<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AutoScore: An Interpretable Machine Learning-Based Automatic Clinical Score Generator - 5&nbsp; AutoScore for survival outcomes (AutoScore-Survival)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-autoscore_ordinal.html" rel="next">
<link href="./04-autoscore.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AutoScore for survival outcomes (AutoScore-Survival)</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">AutoScore: An Interpretable Machine Learning-Based Automatic Clinical Score Generator</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">AutoScore Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-related_papers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Related papers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data_processing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data processing and checking</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-desc_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Descriptive analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-autoscore.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AutoScore for binary outcomes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-autoscore_survival.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AutoScore for survival outcomes (AutoScore-Survival)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-autoscore_ordinal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AutoScore for ordinal outcomes (AutoScore-Ordinal)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#demo1" id="toc-demo1" class="nav-link active" data-scroll-target="#demo1"><span class="toc-section-number">5.1</span>  Demo 1: large sample</a>
  <ul class="collapse">
  <li><a href="#stepi-generate-variable-ranking-list" id="toc-stepi-generate-variable-ranking-list" class="nav-link" data-scroll-target="#stepi-generate-variable-ranking-list"><span class="toc-section-number">5.1.1</span>  STEP(i): Generate variable ranking list</a></li>
  <li><a href="#stepii-select-variables-with-parsimony-plot" id="toc-stepii-select-variables-with-parsimony-plot" class="nav-link" data-scroll-target="#stepii-select-variables-with-parsimony-plot"><span class="toc-section-number">5.1.2</span>  STEP(ii): Select variables with parsimony plot</a></li>
  <li><a href="#stepiii-generate-initial-scores-with-final-variables" id="toc-stepiii-generate-initial-scores-with-final-variables" class="nav-link" data-scroll-target="#stepiii-generate-initial-scores-with-final-variables"><span class="toc-section-number">5.1.3</span>  STEP(iii): Generate initial scores with final variables</a></li>
  <li><a href="#stepiv-fine-tune-initial-score-from-stepiii" id="toc-stepiv-fine-tune-initial-score-from-stepiii" class="nav-link" data-scroll-target="#stepiv-fine-tune-initial-score-from-stepiii"><span class="toc-section-number">5.1.4</span>  STEP(iv): Fine-tune initial score from STEP(iii)</a></li>
  <li><a href="#stepv-evaluate-final-risk-scores-on-test-dataset" id="toc-stepv-evaluate-final-risk-scores-on-test-dataset" class="nav-link" data-scroll-target="#stepv-evaluate-final-risk-scores-on-test-dataset"><span class="toc-section-number">5.1.5</span>  STEP(v): Evaluate final risk scores on test dataset</a></li>
  <li><a href="#score-to-risk" id="toc-score-to-risk" class="nav-link" data-scroll-target="#score-to-risk"><span class="toc-section-number">5.1.6</span>  Map score to risk</a></li>
  </ul></li>
  <li><a href="#demo2" id="toc-demo2" class="nav-link" data-scroll-target="#demo2"><span class="toc-section-number">5.2</span>  Demo 2: small sample</a>
  <ul class="collapse">
  <li><a href="#stepi-generate-variable-ranking-list-1" id="toc-stepi-generate-variable-ranking-list-1" class="nav-link" data-scroll-target="#stepi-generate-variable-ranking-list-1"><span class="toc-section-number">5.2.1</span>  STEP(i): Generate variable ranking list</a></li>
  <li><a href="#stepii-select-the-best-model-with-parsimony-plot" id="toc-stepii-select-the-best-model-with-parsimony-plot" class="nav-link" data-scroll-target="#stepii-select-the-best-model-with-parsimony-plot"><span class="toc-section-number">5.2.2</span>  STEP(ii): Select the best model with parsimony plot</a></li>
  <li><a href="#stepiii-generate-initial-scores-with-final-variables-1" id="toc-stepiii-generate-initial-scores-with-final-variables-1" class="nav-link" data-scroll-target="#stepiii-generate-initial-scores-with-final-variables-1"><span class="toc-section-number">5.2.3</span>  STEP(iii): Generate initial scores with final variables</a></li>
  <li><a href="#stepiv-fine-tune-initial-score-from-stepiii-1" id="toc-stepiv-fine-tune-initial-score-from-stepiii-1" class="nav-link" data-scroll-target="#stepiv-fine-tune-initial-score-from-stepiii-1"><span class="toc-section-number">5.2.4</span>  STEP(iv): Fine-tune initial score from STEP(iii)</a></li>
  <li><a href="#stepv-evaluate-final-risk-scores-on-test-dataset-1" id="toc-stepv-evaluate-final-risk-scores-on-test-dataset-1" class="nav-link" data-scroll-target="#stepv-evaluate-final-risk-scores-on-test-dataset-1"><span class="toc-section-number">5.2.5</span>  STEP(v): Evaluate final risk scores on test dataset</a></li>
  <li><a href="#map-score-to-risk" id="toc-map-score-to-risk" class="nav-link" data-scroll-target="#map-score-to-risk"><span class="toc-section-number">5.2.6</span>  Map score to risk</a></li>
  </ul></li>
  <li><a href="#demo3" id="toc-demo3" class="nav-link" data-scroll-target="#demo3"><span class="toc-section-number">5.3</span>  Demo 3: data with missing values</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="top" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AutoScore for survival outcomes (AutoScore-Survival)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>AutoScore-Survival refers to the AutoScore framework for developing point-based scoring models for survival outcomes. Similar to the implementation described in <a href="./04-autoscore.html#top">Chapter 4</a> for binary outcomes, AutoScore-Survival is implemented by five functions: <code>AutoScore_rank_Survival()</code>, <code>AutoScore_parsimony_Survival()</code>, <code>AutoScore_weighting_Survival()</code>, <code>AutoScore_fine_tuning_Survival()</code> and <code>AutoScore_testing_Survival()</code>.</p>
<p>In this chapter, we demonstrate the use of AutoScore-Survival to develop sparse risk scores for a survival outcome, adjust parameters to improve interpretability, assess the performance of the final model and map the score to predict risks for new data. To facilitate clinical applications, in the following sections we demonstrate AutoScore application in 3 demos with large and small datasets and with missing information.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Scoring models below are based on simulated data to demonstrate AutoScore usage.</em></li>
<li><em>Variable names are intentionally masked to avoid misinterpretation and misuse.</em></li>
</ul>
</div>
</div>
<p>Citation for AutoScore-Survival:</p>
<ul>
<li>Xie F, Ning Y, Yuan H, Goldstein BA, Ong ME, Liu N, Chakraborty B. AutoScore-Survival: Developing interpretable machine learning-based time-to-event scores with right-censored survival data. <em>Journal of Biomedical Informatics</em> 2022;125:103959. (<a href="http://dx.doi.org/10.1016/j.jbi.2021.103959" class="uri">http://dx.doi.org/10.1016/j.jbi.2021.103959</a>)</li>
</ul>
<section id="demo1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="demo1"><span class="header-section-number">5.1</span> Demo 1: large sample</h2>
<p>In Demo 1, we demonstrate the use of AutoScore-Survival on a dataset with 20,000 observations using split-sample approach (i.e., to randomly divide the full dataset into training, validation and test sets) for model development.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Before proceeding, follow the steps in <a href="./03-data_processing.html#top">Chapter 2</a> to ensure all data requirements are met.</em></li>
<li><em>Refer to <a href="./02-desc_analysis.html#survival">Chapter 3</a> for how to generate simple descriptive statistics before building prediction models.</em></li>
</ul>
</div>
</div>
<p class="p-h3">
Load package and data
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AutoScore)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sample_data_survival"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">check_data_survival</span>(sample_data_survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data type check passed. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No NA in data. </code></pre>
</div>
</div>
<p class="p-h3">
Prepare training, validation, and test datasets
</p>
<ul>
<li>Option 1: Prepare three separate datasets to train, validate, and test models.</li>
<li>Option 2: Use demo codes below to randomly split your dataset into training, validation, and test datasets (70%, 10%, 20%, respectively).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_survival, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stepi-generate-variable-ranking-list" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="stepi-generate-variable-ranking-list"><span class="header-section-number">5.1.1</span> STEP(i): Generate variable ranking list</h3>
<p class="autoscore-module">
AutoScore-Survival Modules 1
</p>
<ul>
<li>Variables are ranked using random survival forest.</li>
<li><code>ntree</code>: Number of trees required only if when <code>method</code> is “rf” (Default: 100).</li>
<li>Run time increases with larger <code>ntree</code> value. Code below uses <code>ntree = 5</code> for demonstration.</li>
</ul>
<div class="cell" data-hash="05-autoscore_survival_cache/html/rank_surv_06a0463d26f07c3fe52d633d85bd2814">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Survival</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Trees Grown:       1,    Time Remaining (sec):       0 
Trees Grown:       5,    Time Remaining (sec):       0 


The ranking based on variable importance was shown below for each variable: 
    Vital_E       Lab_H         Age       Lab_K     Vital_A       Lab_B 
0.165608652 0.160762453 0.128912855 0.128557962 0.045219867 0.040417391 
      Lab_G     Vital_C       Lab_M     Vital_B       Lab_C     Vital_D 
0.024342208 0.022561527 0.020905397 0.018080011 0.016227841 0.014980410 
      Lab_J       Lab_F     Vital_F       Lab_L     Vital_G       Lab_I 
0.013780700 0.012120477 0.011200870 0.008297275 0.006354309 0.005682440 
      Lab_E       Lab_D       Lab_A 
0.005093323 0.004567277 0.004141324 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/rank_surv-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stepii-select-variables-with-parsimony-plot" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="stepii-select-variables-with-parsimony-plot"><span class="header-section-number">5.1.2</span> STEP(ii): Select variables with parsimony plot</h3>
<p class="autoscore-module">
AutoScore-Survival Modules 2+3+4
</p>
<ul>
<li><code>n_min</code>: Minimum number of selected variables (Default: 1).</li>
<li><code>n_max</code>: Maximum number of selected variables (Default: 20).</li>
<li><code>categorize</code>: Methods for categorizing continuous variables. Options include <code>"quantile"</code> or <code>"kmeans"</code> (Default: <code>"quantile"</code>).</li>
<li><code>quantiles</code>: Predefined quantiles to convert continuous variables to categorical ones. (Default: <code>c(0, 0.05, 0.2, 0.8, 0.95, 1)</code>) Available if <code>categorize = "quantile"</code>.</li>
<li><code>max_cluster</code>: The maximum number of cluster (Default: 5). Available if <code>categorize = "kmeans"</code>.</li>
<li><code>max_score</code>: Maximum total score (Default: 100).</li>
<li><code>auc_lim_min</code>: Minimum y_axis limit in the parsimony plot (Default: 0.5).</li>
<li><code>auc_lim_max</code>: Maximum y_axis limit in the parsimony plot (Default: “adaptive”).</li>
</ul>
<div class="cell" data-hash="05-autoscore_survival_cache/html/iauc_surv_bb8a770a79e70da30d092dea6ca92d1e">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>iAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Survival</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> ranking, <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="fl">0.5</span>, <span class="at">auc_lim_max =</span> <span class="st">"adaptive"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Select 1 Variable(s):  0.6651428 
Select 2 Variable(s):  0.7474401 
Select 3 Variable(s):  0.8111006 
Select 4 Variable(s):  0.8416833 
Select 5 Variable(s):  0.867012 
Select 6 Variable(s):  0.8779297 
Select 7 Variable(s):  0.8809597 
Select 8 Variable(s):  0.8830361 
Select 9 Variable(s):  0.8875346 
Select 10 Variable(s):  0.8905936 
Select 11 Variable(s):  0.8902906 
Select 12 Variable(s):  0.8906035 
Select 13 Variable(s):  0.8930109 
Select 14 Variable(s):  0.8927079 
Select 15 Variable(s):  0.8935644 
Select 16 Variable(s):  0.8922507 
Select 17 Variable(s):  0.8926088 
Select 18 Variable(s):  0.89691 
Select 19 Variable(s):  0.8981632 
Select 20 Variable(s):  0.8983681 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/iauc_surv-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>iAUC</code> for further analysis or export it to CSV to other software for plotting.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(iAUC), <span class="at">file =</span> <span class="st">"iAUC.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Determine the optimal number of variables (<code>num_var</code>) based on the parsimony plot obtained in STEP(ii).</li>
<li>The final list of variables is the first <code>num_var</code> variables in the ranked list <code>ranking</code> obtained in STEP(i).</li>
<li>Optional: User can adjust the finally included variables <code>final_variables</code> based on the clinical preferences and knowledge.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Top 6 variables are selected</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: Top 9 variables are selected</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: Top 6 variables, the 9th and 10th variable are selected</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>num_var, <span class="dv">9</span>, <span class="dv">10</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stepiii-generate-initial-scores-with-final-variables" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="stepiii-generate-initial-scores-with-final-variables"><span class="header-section-number">5.1.3</span> STEP(iii): Generate initial scores with final variables</h3>
<p class="autoscore-module">
Re-run AutoScore-Survival Modules 2+3
</p>
<ul>
<li>Generate <code>cut_vec</code> with current cutoffs of continuous variables, which can be fine-tuned in STEP(iv).</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Survival</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1       Vital_E
2         Lab_H
3           Age
4         Lab_K
5       Vital_A
6         Lab_B
****Initial Scores: 


========  ==========  =====
variable  interval    point
========  ==========  =====
Vital_E   &lt;12           0  
          [12,15)       5  
          [15,22)      11  
          [22,25)      16  
          &gt;=25         18  
                           
Lab_H     &lt;0.2          0  
          [0.2,1.1)     3  
          [1.1,3.1)     8  
          [3.1,4)      13  
          &gt;=4          18  
                           
Age       &lt;35           0  
          [35,49)       5  
          [49,76)      13  
          [76,89)      21  
          &gt;=89         24  
                           
Lab_K     &lt;8            0  
          [8,42)        5  
          [42,58)      11  
          &gt;=58         13  
                           
Vital_A   &lt;60           0  
          [60,73)       3  
          [73,98)       8  
          [98,111)     11  
          &gt;=111        13  
                           
Lab_B     &lt;8.5          0  
          [8.5,11.2)    3  
          [11.2,17)     8  
          [17,19.8)    11  
          &gt;=19.8       13  
========  ==========  =====
Integrated AUC by all time points: 0.8779297
C_index:  0.785738 
The AUC(t) are shown as bwlow:
  time_point     AUC_t
1          1 0.0002500
2          3 1.0000000
3          7 0.9927981
4         14 0.9872613
5         30 0.9433755
6         60 0.8735564
7         90 0.8599778
***The cutoffs of each variable generated by the AutoScore are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>
</section>
<section id="stepiv-fine-tune-initial-score-from-stepiii" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="stepiv-fine-tune-initial-score-from-stepiii"><span class="header-section-number">5.1.4</span> STEP(iv): Fine-tune initial score from STEP(iii)</h3>
<p class="autoscore-module">
AutoScore-Survival Module 5 &amp; Re-run AutoScore-Survival Modules 2+3
</p>
<ul>
<li>Revise <code>cut_vec</code> with domain knowledge to update the scoring table (AutoScore-Survival Module 5).</li>
<li>Re-run AutoScore-Survival Modules 2+3 to generate the updated scores.</li>
<li>Users can choose any cutoff values and/or any number of categories, but are suggested to choose numbers close to the automatically determined values.</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For example, we have current cutoffs of continuous variable: Age </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## variable        interval     point</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Age             &lt;35            0  </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [35,49)        5 </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [49,76)       13  </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [76,89)       21  </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                 &gt;=89          24  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Current cutoffs:<code>c(35, 49, 76, 89)</code>. We can fine tune the cutoffs as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: rounding up to a nice number</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: changing cutoffs according to clinical knowledge or preference </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: combining categories</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Then we do similar checks for other variables and update scoring table using new cutoffs if needed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_H <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_K <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">17</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Vital_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">98</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>scoring_table <span class="ot">&lt;-</span> <span class="fu">AutoScore_fine_tuning_Survival</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">cut_vec =</span> cut_vec, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Fine-tuned Scores: 


========  ========  =====
variable  interval  point
========  ========  =====
Vital_E   &lt;12         0  
          [12,15)     4  
          [15,22)    11  
          [22,25)    19  
          &gt;=25       22  
                         
Lab_H     &lt;0.2        0  
          [0.2,1)     4  
          [1,3)      11  
          [3,4)      15  
          &gt;=4        22  
                         
Age       &lt;50         0  
          [50,75)    11  
          [75,90)    19  
          &gt;=90       22  
                         
Lab_K     &lt;10         0  
          [10,40)     7  
          &gt;=40       11  
                         
Vital_A   &lt;70         0  
          [70,98)     7  
          &gt;=98       11  
                         
Lab_B     &lt;10         0  
          [10,17)     4  
          &gt;=17       11  
========  ========  =====
***Performance (based on validation set, after fine-tuning):
Integrated AUC by all time points: 0.8678829
C_index:  0.7772233 
The AUC(t) are shown as bwlow:
  time_point     AUC_t
1          1 0.0002500
2          3 1.0000000
3          7 0.9853457
4         14 0.9867337
5         30 0.9366347
6         60 0.8606470
7         90 0.8585631</code></pre>
</div>
</div>
</section>
<section id="stepv-evaluate-final-risk-scores-on-test-dataset" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="stepv-evaluate-final-risk-scores-on-test-dataset"><span class="header-section-number">5.1.5</span> STEP(v): Evaluate final risk scores on test dataset</h3>
<p class="autoscore-module">
AutoScore-Survival Module 6
</p>
<ul>
<li><code>threshold</code>: Score threshold for the ROC analysis to generate sensitivity, specificity, etc. If set to <code>"best"</code>, the optimal threshold will be calculated (Default: <code>"best"</code>).</li>
<li><code>with_label</code>: Set to <code>TRUE</code> if there are labels in the <code>test_set</code> and performance will be evaluated accordingly (Default: <code>TRUE</code>).</li>
<li>Set the <code>with_label</code> to <code>FALSE</code> if there are not <code>label</code> in the <code>test_set</code> and the final predicted scores will be the output without performance evaluation.</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pred_score <span class="ot">&lt;-</span> <span class="fu">AutoScore_testing_Survival</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_set =</span> test_set, <span class="at">final_variables =</span> final_variables, <span class="at">cut_vec =</span> cut_vec, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scoring_table =</span> scoring_table, <span class="at">threshold =</span> <span class="st">"best"</span>, <span class="at">with_label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Performance using AutoScore (based on unseen test Set):
Integrated AUC by all time points: 0.873 (0.864-0.88)
C_index:  0.782 (0.773-0.789) 
The AUC(t) are shown as bwlow:
  time_point               AUC_t
1          1     0.637 (0-0.997)
2          3  0.955 (0.91-0.996)
3          7 0.969 (0.939-0.992)
4         14 0.946 (0.921-0.974)
5         30 0.937 (0.923-0.949)
6         60 0.865 (0.854-0.875)
7         90  0.865 (0.85-0.877)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pred_score label_time label_status
1         19         91        FALSE
2         44         60         TRUE
3         70         43         TRUE
4         37         90         TRUE
5         51         62         TRUE
6         33         91        FALSE</code></pre>
</div>
</div>
</section>
<section id="score-to-risk" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="score-to-risk"><span class="header-section-number">5.1.6</span> Map score to risk</h3>
<p>Further analysis to map score to risk (e.g., conversion table, Kaplan Meier Curve, output the score).</p>
<ul>
<li>Use <code>plot_survival_km()</code> to generate Kaplan-Meier curve under different score thresholds (decided by users, e.g., 50).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_survival_km</span>(<span class="at">pred_score =</span> pred_score, <span class="at">score_cut =</span> <span class="fu">c</span>(<span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>User can also use several score thresholds to cut the score for generate Kaplan-Meier curve.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_survival_km</span>(pred_score, <span class="at">score_cut =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Use <code>conversion_table_survival()</code> to generate the performance under different <code>score_cut</code> score cut-offs.</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">conversion_table_survival</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_score =</span> pred_score, <span class="at">score_cut =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>), </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>pred_score</code> for further analysis or export it to CSV to other software (e.g., generating the calibration curve).</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(pred_score, <span class="at">file =</span> <span class="st">"pred_score.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="demo2" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="demo2"><span class="header-section-number">5.2</span> Demo 2: small sample</h2>
<p>In Demo 2, we demonstrate the use of AutoScore-Survival on a smaller dataset where there are no sufficient samples to form a separate training and validation dataset. Thus, the cross validation is employed to generate the parsimony plot.</p>
<p class="p-h3">
Load small dataset with 1000 samples
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sample_data_survival_small"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p class="p-h3">
Prepare training and test datasets
</p>
<ul>
<li>Option 1: Prepare two separate datasets to train and test models.</li>
<li>Option 2: Use demo codes below to randomly split your dataset into training and test datasets (70% and 30%, respectively). For cross-validation, <code>train_set</code> is equal to <code>validation_set</code> and the ratio of <code>validation_set</code> should be 0. Then cross-validation will be implemented in the STEP(ii) <code>AutoScore_parsimony_Survival()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_survival_small, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cross_validation =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stepi-generate-variable-ranking-list-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="stepi-generate-variable-ranking-list-1"><span class="header-section-number">5.2.1</span> STEP(i): Generate variable ranking list</h3>
<p class="autoscore-module">
AutoScore-Survival Modules 1
</p>
<ul>
<li>Variables are ranked using random survival forest.</li>
<li><code>ntree</code>: Number of trees required only if when <code>method</code> is “rf” (Default: 100).</li>
<li>Run time increases with larger <code>ntree</code> value. Code below uses <code>ntree = 5</code> for demonstration.</li>
</ul>
<div class="cell" data-hash="05-autoscore_survival_cache/html/rank_surv_small_4e2f6843fd0f97d3c0729d6c7f590194">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Survival</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Trees Grown:       1,    Time Remaining (sec):       0 


The ranking based on variable importance was shown below for each variable: 
      Vital_E         Lab_H           Age         Lab_K         Lab_B 
 1.056965e-01  9.211654e-02  9.174663e-02  6.298467e-02  6.046187e-02 
      Vital_F       Vital_A         Lab_F         Lab_J       Vital_C 
 4.304715e-02  3.741877e-02  2.783056e-02  2.610612e-02  1.774737e-02 
        Lab_E         Lab_C         Lab_M       Vital_B         Lab_G 
 1.674145e-02  1.518732e-02  1.430115e-02  1.422398e-02  9.859650e-03 
      Vital_D         Lab_I         Lab_A       Vital_G         Lab_L 
 7.664181e-03  4.044984e-03  2.562711e-03  0.000000e+00 -2.395057e-05 
        Lab_D 
-7.823852e-04 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/rank_surv_small-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stepii-select-the-best-model-with-parsimony-plot" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="stepii-select-the-best-model-with-parsimony-plot"><span class="header-section-number">5.2.2</span> STEP(ii): Select the best model with parsimony plot</h3>
<p class="autoscore-module">
</p><p>AutoScore-Survival Modules 2+3+4/p&gt;</p>
<ul>
<li><code>nmin</code>: Minimum number of selected variables (Default: 1).</li>
<li><code>nmax</code>: Maximum number of selected variables (Default: 20).</li>
<li><code>categorize</code>: Methods for categorizing continuous variables. Options include <code>"quantile"</code> or <code>"kmeans"</code> (Default: <code>"quantile"</code>).</li>
<li><code>quantiles</code>: Predefined quantiles to convert continuous variables to categorical ones. (Default: <code>c(0, 0.05, 0.2, 0.8, 0.95, 1)</code>) Available if <code>categorize = "quantile"</code>.</li>
<li><code>max_cluster</code>: The maximum number of cluster (Default: 5). Available if <code>categorize = "kmeans"</code>.</li>
<li><code>max_score</code>: Maximum total score (Default: 100).</li>
<li><code>auc_lim_min</code>: Minimum y_axis limit in the parsimony plot (Default: 0.5).</li>
<li><code>auc_lim_max</code>: Maximum y_axis limit in the parsimony plot (Default: “adaptive”).</li>
<li><code>cross_validation</code>: <code>TRUE</code> if cross-validation is needed, especially for small datasets.</li>
<li><code>fold</code>: The number of folds used in cross validation (Default: 10). Available if <code>cross_validation = TRUE</code>.</li>
<li><code>do_trace</code>: If set to <code>TRUE</code>, all results based on each fold of cross-validation would be printed out and plotted (Default: <code>FALSE</code>). Available if <code>cross_validation = TRUE</code>.</li>
</ul>
<div class="cell" data-hash="05-autoscore_survival_cache/html/iauc_surv_small_5be03b79f47b176f679cc3d36d4eb325">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>iAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Survival</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, <span class="at">rank =</span> ranking,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="fl">0.5</span>, <span class="at">auc_lim_max =</span> <span class="st">"adaptive"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cross_validation =</span> <span class="cn">TRUE</span>, <span class="at">fold =</span> <span class="dv">10</span>, <span class="at">do_trace =</span> <span class="cn">FALSE</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***list of final mean AUC values through cross-validation are shown below 
   auc_set.sum
1    0.6360233
2    0.7296583
3    0.7991611
4    0.8326020
5    0.8344274
6    0.8318417
7    0.8449623
8    0.8499911
9    0.8522826
10   0.8560715
11   0.8547488
12   0.8537975
13   0.8601176
14   0.8637747
15   0.8626508
16   0.8588067
17   0.8681878
18   0.8682324
19   0.8665358
20   0.8663715</code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/iauc_surv_small-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>Users could use <code>iAUC</code> for further analysis or export it to CSV to other software for plotting.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">data.frame</span>(iAUC), <span class="at">file =</span> <span class="st">"iAUC.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li>Determine the optimal number of variables (<code>num_var</code>) based on the parsimony plot obtained in STEP(ii).</li>
<li>The final list of variables is the first <code>num_var</code> variables in the ranked list <code>ranking</code> obtained in STEP(i).</li>
<li>Optional: User can adjust the finally included variables <code>final_variables</code> based on the clinical preferences and knowledge.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: Top 6 variables are selected</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: Top 9 variables are selected</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: Top 6 variables, the 9th and 10th variable are selected</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>num_var, <span class="dv">9</span>, <span class="dv">10</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stepiii-generate-initial-scores-with-final-variables-1" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="stepiii-generate-initial-scores-with-final-variables-1"><span class="header-section-number">5.2.3</span> STEP(iii): Generate initial scores with final variables</h3>
<p class="autoscore-module">
Re-run AutoScore-Survival Modules 2+3
</p>
<ul>
<li>Generate <code>cut_vec</code> with current cutoffs of continuous variables, which can be fine-tuned in STEP(iv).</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Survival</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1       Vital_E
2         Lab_H
3           Age
4         Lab_K
5         Lab_B
6       Vital_F
****Initial Scores: 


========  ===========  =====
variable  interval     point
========  ===========  =====
Vital_E   &lt;12            0  
          [12,15)        5  
          [15,22)       15  
          [22,25)       21  
          &gt;=25          22  
                            
Lab_H     &lt;0.1           0  
          [0.1,1.2)      4  
          [1.2,3.1)     11  
          [3.1,4.1)     20  
          &gt;=4.1         24  
                            
Age       &lt;37            0  
          [37,49)        2  
          [49,76)        8  
          [76,89)       16  
          &gt;=89          22  
                            
Lab_K     &lt;8             0  
          [8,42)         7  
          [42,59)       12  
          &gt;=59          14  
                            
Lab_B     &lt;9             0  
          [9,11.5)       3  
          [11.5,16.9)    4  
          [16.9,19.8)   10  
          &gt;=19.8        14  
                            
Vital_F   &lt;35.9          3  
          [35.9,36.3)    2  
          [36.3,37.3)    2  
          [37.3,37.7)    0  
          &gt;=37.7         0  
========  ===========  =====
Integrated AUC by all time points: 0.8551594
C_index:  0.7644388 
The AUC(t) are shown as bwlow:
  time_point     AUC_t
1          1 0.9971388
2          3 0.9770774
3          7 0.9770774
4         14 0.9856115
5         30 0.9005364
6         60 0.8520291
7         90 0.8462442
***The cutoffs of each variable generated by the AutoScore are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>
</section>
<section id="stepiv-fine-tune-initial-score-from-stepiii-1" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="stepiv-fine-tune-initial-score-from-stepiii-1"><span class="header-section-number">5.2.4</span> STEP(iv): Fine-tune initial score from STEP(iii)</h3>
<p class="autoscore-module">
AutoScore-Survival Module 5 &amp; Re-run AutoScore-Survival Modules 2+3
</p>
<ul>
<li>Revise <code>cut_vec</code> with domain knowledge to update the scoring table (AutoScore-Survival Module 5).</li>
<li>Re-run AutoScore-Survival Modules 2+3 to generate the updated scores.</li>
<li>Users can choose any cutoff values and/or any number of categories, but are suggested to choose numbers close to the automatically determined values.</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For example, we have current cutoffs of continuous variable: Age </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## variable        interval     point</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ==============  ===========  =====</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Age             &lt;35            0  </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [35,49)        2  </span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [49,76)        8  </span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                 [76,89)       16  </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                 &gt;=89          22  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Current cutoffs:<code>c(35, 49, 76, 89)</code>. We can fine tune the cutoffs as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1: rounding up to a nice number</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: changing cutoffs according to clinical knowledge or preference </span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3: combining categories</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Then we do similar checks for other variables and update scoring table using new cutoffs if needed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_H <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_K <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Lab_B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">17</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>cut_vec<span class="sc">$</span>Vital_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">98</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>scoring_table <span class="ot">&lt;-</span> <span class="fu">AutoScore_fine_tuning_Survival</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">cut_vec =</span> cut_vec, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Fine-tuned Scores: 


========  ===========  =====
variable  interval     point
========  ===========  =====
Vital_E   &lt;12            0  
          [12,15)        3  
          [15,22)       15  
          [22,25)       21  
          &gt;=25          23  
                            
Lab_H     &lt;0.2           0  
          [0.2,1)        3  
          [1,3)         11  
          [3,4)         20  
          &gt;=4           26  
                            
Age       &lt;50            0  
          [50,75)        9  
          [75,90)       15  
          &gt;=90          23  
                            
Lab_K     &lt;10            0  
          [10,40)        9  
          &gt;=40          15  
                            
Lab_B     &lt;10            0  
          [10,17)        3  
          &gt;=17           9  
                            
Vital_F   &lt;35.9          4  
          [35.9,36.3)    1  
          [36.3,37.3)    2  
          [37.3,37.7)    0  
          &gt;=37.7         0  
========  ===========  =====
***Performance (based on validation set, after fine-tuning):
Integrated AUC by all time points: 0.8535286
C_index:  0.7634054 
The AUC(t) are shown as bwlow:
  time_point     AUC_t
1          1 1.0000000
2          3 0.9674069
3          7 0.9674069
4         14 0.9772662
5         30 0.8922335
6         60 0.8466340
7         90 0.8518403</code></pre>
</div>
</div>
</section>
<section id="stepv-evaluate-final-risk-scores-on-test-dataset-1" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="stepv-evaluate-final-risk-scores-on-test-dataset-1"><span class="header-section-number">5.2.5</span> STEP(v): Evaluate final risk scores on test dataset</h3>
<p class="autoscore-module">
AutoScore-Survival Module 6
</p>
<ul>
<li><code>threshold</code>: Score threshold for the ROC analysis to generate sensitivity, specificity, etc. If set to <code>"best"</code>, the optimal threshold will be calculated (Default: <code>"best"</code>).</li>
<li><code>with_label</code>: Set to <code>TRUE</code> if there are labels in the <code>test_set</code> and performance will be evaluated accordingly (Default: <code>TRUE</code>).</li>
<li>Set the <code>with_label</code> to <code>FALSE</code> if there are not <code>label</code> in the <code>test_set</code> and the final predicted scores will be the output without performance evaluation.</li>
<li><code>time_point</code>: The time points to be evaluated using time-dependent AUC(t).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pred_score <span class="ot">&lt;-</span> <span class="fu">AutoScore_testing_Survival</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_set =</span> test_set, <span class="at">final_variables =</span> final_variables, <span class="at">cut_vec =</span> cut_vec, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scoring_table =</span> scoring_table, <span class="at">threshold =</span> <span class="st">"best"</span>, <span class="at">with_label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_point =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***Performance using AutoScore (based on unseen test Set):
Integrated AUC by all time points: 0.872 (0.848-0.898)
C_index:  0.78 (0.751-0.805) 
The AUC(t) are shown as bwlow:
  time_point               AUC_t
1          1 0.003 (0.002-0.007)
2          3 0.003 (0.002-0.007)
3          7     0.651 (0.002-1)
4         14     0.864 (0.002-1)
5         30 0.944 (0.901-0.981)
6         60 0.856 (0.814-0.902)
7         90 0.852 (0.801-0.892)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pred_score label_time label_status
1         67         52         TRUE
2         26         91        FALSE
3         49         75         TRUE
4         70         59         TRUE
5         30         91        FALSE
6         47         91        FALSE</code></pre>
</div>
</div>
</section>
<section id="map-score-to-risk" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="map-score-to-risk"><span class="header-section-number">5.2.6</span> Map score to risk</h3>
<ul>
<li>Users can also generate conversion table using <code>conversion_table_survival()</code>, and Kaplan-Meier curve using <code>plot_survival_km()</code>. Please refer to <a href="#score-to-risk">our demo for large sample</a> for detail.</li>
</ul>
</section>
</section>
<section id="demo3" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="demo3"><span class="header-section-number">5.3</span> Demo 3: data with missing values</h2>
<p>In Demo #3, we demonstrate the use of AutoScore on a dataset with missing values in two variables (i.e., Vital_A, Vital_B).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_data_survival</span>(sample_data_survival_missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data type check passed. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
WARNING: NA detected in data: -----</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Variable name No. missing %missing
Vital_A       Vital_A        4000       20
Vital_B       Vital_B       12000       60</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>SUGGESTED ACTION:
 * Consider imputation and supply AutoScore with complete data.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> * Alternatively, AutoScore can handle missing values as a separate 'Unknown' category, IF:
    - you believe the missingness in your dataset is informative, AND
    - missing is prevalent enough that you prefer to preserve them as NA rather than removing or doing imputation, AND
    - missing is not too prevalent, which may make results unstable.</code></pre>
</div>
</div>
<p>AutoScore can automatically treat the missingness as a new category named <code>Unknown</code>. The following steps are the <strong>same</strong> as those in <a href="#demo1">Demo 1</a>.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>High missing rate may cause the variable ranking less reliable, and thus, caution is needed for variable selection using parsimony plot.</em></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>out_split <span class="ot">&lt;-</span> <span class="fu">split_data</span>(<span class="at">data =</span> sample_data_survival, <span class="at">ratio =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>train_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>train_set</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>validation_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>validation_set</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> out_split<span class="sc">$</span>test_set</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>ranking <span class="ot">&lt;-</span> <span class="fu">AutoScore_rank_Survival</span>(<span class="at">train_set =</span> train_set, <span class="at">ntree =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Trees Grown:       1,    Time Remaining (sec):       0 
Trees Grown:       5,    Time Remaining (sec):       0 


The ranking based on variable importance was shown below for each variable: 
    Vital_E       Lab_H         Age       Lab_K     Vital_A       Lab_B 
0.165608652 0.160762453 0.128912855 0.128557962 0.045219867 0.040417391 
      Lab_G     Vital_C       Lab_M     Vital_B       Lab_C     Vital_D 
0.024342208 0.022561527 0.020905397 0.018080011 0.016227841 0.014980410 
      Lab_J       Lab_F     Vital_F       Lab_L     Vital_G       Lab_I 
0.013780700 0.012120477 0.011200870 0.008297275 0.006354309 0.005682440 
      Lab_E       Lab_D       Lab_A 
0.005093323 0.004567277 0.004141324 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>iAUC <span class="ot">&lt;-</span> <span class="fu">AutoScore_parsimony_Survival</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> ranking, <span class="at">max_score =</span> <span class="dv">100</span>, <span class="at">n_min =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">20</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">auc_lim_min =</span> <span class="fl">0.5</span>, <span class="at">auc_lim_max =</span> <span class="st">"adaptive"</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Select 1 Variable(s):  0.6651428 
Select 2 Variable(s):  0.7474401 
Select 3 Variable(s):  0.8111006 
Select 4 Variable(s):  0.8416833 
Select 5 Variable(s):  0.867012 
Select 6 Variable(s):  0.8779297 
Select 7 Variable(s):  0.8809597 
Select 8 Variable(s):  0.8830361 
Select 9 Variable(s):  0.8875346 
Select 10 Variable(s):  0.8905936 
Select 11 Variable(s):  0.8902906 
Select 12 Variable(s):  0.8906035 
Select 13 Variable(s):  0.8930109 
Select 14 Variable(s):  0.8927079 
Select 15 Variable(s):  0.8935644 
Select 16 Variable(s):  0.8922507 
Select 17 Variable(s):  0.8926088 
Select 18 Variable(s):  0.89691 
Select 19 Variable(s):  0.8981632 
Select 20 Variable(s):  0.8983681 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="05-autoscore_survival_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>The <code>Unknown</code> category indicating the missingness will be displayed in the final scoring table.</em></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>final_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(ranking[<span class="dv">1</span><span class="sc">:</span>num_var])</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>cut_vec <span class="ot">&lt;-</span> <span class="fu">AutoScore_weighting_Survival</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_set =</span> train_set, <span class="at">validation_set =</span> validation_set, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">final_variables =</span> final_variables, <span class="at">max_score =</span> <span class="dv">100</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">categorize =</span> <span class="st">"quantile"</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span>, <span class="dv">1</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>****Included Variables: 
  variable_name
1       Vital_E
2         Lab_H
3           Age
4         Lab_K
5       Vital_A
6         Lab_B
****Initial Scores: 


========  ==========  =====
variable  interval    point
========  ==========  =====
Vital_E   &lt;12           0  
          [12,15)       5  
          [15,22)      11  
          [22,25)      16  
          &gt;=25         18  
                           
Lab_H     &lt;0.2          0  
          [0.2,1.1)     3  
          [1.1,3.1)     8  
          [3.1,4)      13  
          &gt;=4          18  
                           
Age       &lt;35           0  
          [35,49)       5  
          [49,76)      13  
          [76,89)      21  
          &gt;=89         24  
                           
Lab_K     &lt;8            0  
          [8,42)        5  
          [42,58)      11  
          &gt;=58         13  
                           
Vital_A   &lt;60           0  
          [60,73)       3  
          [73,98)       8  
          [98,111)     11  
          &gt;=111        13  
                           
Lab_B     &lt;8.5          0  
          [8.5,11.2)    3  
          [11.2,17)     8  
          [17,19.8)    11  
          &gt;=19.8       13  
========  ==========  =====
Integrated AUC by all time points: 0.8779297
C_index:  0.785738 
The AUC(t) are shown as bwlow:
  time_point     AUC_t
1          1 0.0002500
2          3 1.0000000
3          7 0.9927981
4         14 0.9872613
5         30 0.9433755
6         60 0.8735564
7         90 0.8599778
***The cutoffs of each variable generated by the AutoScore are saved in cut_vec. You can decide whether to revise or fine-tune them </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./04-autoscore.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AutoScore for binary outcomes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-autoscore_ordinal.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">AutoScore for ordinal outcomes (AutoScore-Ordinal)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>